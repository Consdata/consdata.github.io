I"¢¥<p>KaÅ¼da nietrywialna aplikacja potrzebuje backendu. O ile obecnie to nie jest prawda, to na potrzeby tego artykuÅ‚u przyjmijmy, Å¼e tak jest. A jak backend wspÃ³Å‚pracujÄ…cy z aplikacjÄ… webowÄ… to <em>REST</em>, a jak <em>REST</em> to <em>Spring</em> i <em>Spring Boot</em>. W kilku kolejnych akapitach stworzymy i z sukcesem przygotujemy gotowy do wdroÅ¼enia artefakt skÅ‚adajÄ…cy siÄ™ z aplikacji webowej w <em>Angular 2</em> i backendu usÅ‚ugowego wykorzystujÄ…cego <em>Spring Boot</em>.</p>

<p><em>ArtykuÅ‚ zakÅ‚ada podstawowÄ… znajomoÅ›Ä‡ Angular CLI, Spring Boot i Maven.</em></p>

<p><em>Wszystkie przedstawione kroki sÄ… commitami do testowego repozytorium, dziÄ™ki temu sam moÅ¼esz przeÅ›ledziÄ‡ proces tworzenia aplikacji oraz rozwiaÄ‡ wszelkie wÄ…tpliwoÅ›ci. Link do repozytorium: <a href="https://github.com/glipecki/spring-with-angular-cli-demo">demo@github</a>.</em></p>

<h2 id="stworzenie-minimalnego-projektu">Stworzenie minimalnego projektu</h2>

<p>Nowy projekt najÅ‚atwiej stworzymy wykorzystujÄ…c <em>Spring Initializer</em>, moÅ¼emy to zrobiÄ‡ wchodzÄ…c <a href="http://start.spring.io/">http://start.spring.io/</a> i wyklikujÄ…c konfiguracjÄ™ projektu, lub moÅ¼emy to zrobiÄ‡ w stylu prawdziwego geeka - <em>curlem</em>.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">cd </span>demo
<span class="nv">$ </span>curl https://start.spring.io/starter.tgz <span class="se">\</span>
  <span class="nt">-d</span> <span class="nv">groupId</span><span class="o">=</span>net.lipecki.demo <span class="se">\</span>
  <span class="nt">-d</span> <span class="nv">packageName</span><span class="o">=</span>net.lipecki.demo <span class="se">\</span>
  <span class="nt">-d</span> <span class="nv">artifactId</span><span class="o">=</span>demo <span class="se">\</span>
  <span class="nt">-d</span> <span class="nv">dependencies</span><span class="o">=</span>web <span class="se">\</span>
  | <span class="nb">tar</span> <span class="nt">-xzvf</span> -

  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100 50190  100 50104  100    86  54925     94 <span class="nt">--</span>:--:-- <span class="nt">--</span>:--:-- <span class="nt">--</span>:--:-- 54878
x mvnw
x .mvn/
x .mvn/wrapper/
x src/
x src/main/
x src/main/java/
x src/main/java/net/
x src/main/java/net/lipecki/
x src/main/java/net/lipecki/demo/
x src/main/resources/
x src/main/resources/static/
x src/main/resources/templates/
x src/test/
x src/test/java/
x src/test/java/net/
x src/test/java/net/lipecki/
x src/test/java/net/lipecki/demo/
x .gitignore
x .mvn/wrapper/maven-wrapper.jar
x .mvn/wrapper/maven-wrapper.properties
x mvnw.cmd
x pom.xml
x src/main/java/net/lipecki/demo/DemoApplication.java
x src/main/resources/application.properties
x src/test/java/net/lipecki/demo/DemoApplicationTests.java
</code></pre></div></div>

<p>W efekcie dostajemy minimalnÄ… aplikacjÄ™ <em>Spring Boot</em>, ktÃ³rÄ… moÅ¼emy zbudowaÄ‡ i uruchomiÄ‡. Do testÃ³w dorzuÄ‡my prosty kontroler.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>curl <span class="nt">-L</span> https://goo.gl/MbWM8s <span class="nt">-o</span> src/main/java/net/lipecki/demo/GreetingRestController.java
<span class="nv">$ </span><span class="nb">cat </span>src/main/java/net/lipecki/demo/GreetingRestController.java
package net.lipecki.demo<span class="p">;</span>

import org.springframework.web.bind.annotation.RequestMapping<span class="p">;</span>
import org.springframework.web.bind.annotation.RestController<span class="p">;</span>

@RestController
public class GreetingRestController <span class="o">{</span>

	@RequestMapping<span class="o">(</span><span class="s2">"/greeting"</span><span class="o">)</span>
	public String greeting<span class="o">()</span> <span class="o">{</span>
		<span class="k">return</span> <span class="s2">"Welcome!"</span><span class="p">;</span>
	<span class="o">}</span>

<span class="o">}</span>
</code></pre></div></div>

<p>CaÅ‚oÅ›Ä‡ moÅ¼emy zbudowaÄ‡ wykorzystujÄ…c <em>Maven</em>. W zaleÅ¼noÅ›ci od preferencji moÅ¼emy zbudowaÄ‡ aplikacjÄ™ wykorzystujÄ…c globalnie zainstalowanÄ… w systemie instancjÄ™ lub skorzystaÄ‡ z dostarczanego ze szkieletem <em>Maven Wrappera</em>. Stosowanie <em>Wrappera</em> pozwala pracowaÄ‡ z aplikacjÄ… nie zmieniajÄ…c zainstalowanych w systemie pakietÃ³w oraz zapewnia, Å¼e moÅ¼emy rÃ³Å¼ne projekty budowaÄ‡ rÃ³Å¼nymi wersjami <em>Mavena</em>. <em>Wrapper</em> w razie potrzeby Å›ciÄ…gnie odpowiedniÄ… wersjÄ™ bibliotek przy pierwszym uruchomieniu.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./mvnw clean package
 <span class="nb">.</span>
 <span class="nb">.</span>
 <span class="nb">.</span>
<span class="o">[</span>INFO] <span class="nt">---</span> spring-boot-maven-plugin:1.4.2.RELEASE:repackage <span class="o">(</span>default<span class="o">)</span> @ demo <span class="nt">---</span>
<span class="o">[</span>INFO] <span class="nt">------------------------------------------------------------------------</span>
<span class="o">[</span>INFO] BUILD SUCCESS
<span class="o">[</span>INFO] <span class="nt">------------------------------------------------------------------------</span>
<span class="o">[</span>INFO] Total <span class="nb">time</span>: 4.929 s
<span class="o">[</span>INFO] Finished at: 2016-12-07T20:43:32+01:00
<span class="o">[</span>INFO] Final Memory: 28M/325M
<span class="o">[</span>INFO] <span class="nt">------------------------------------------------------------------------</span>
</code></pre></div></div>

<p>uruchomiÄ‡</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>java <span class="nt">-jar</span> target/demo-0.0.1-SNAPSHOT.jar
 <span class="nb">.</span>
 <span class="nb">.</span>
 <span class="nb">.</span>
2016-12-07 20:44:13.392  INFO 70743 <span class="nt">---</span> <span class="o">[</span>           main] s.b.c.e.t.TomcatEmbeddedServletContainer : Tomcat started on port<span class="o">(</span>s<span class="o">)</span>: 8080 <span class="o">(</span>http<span class="o">)</span>
2016-12-07 20:44:13.397  INFO 70743 <span class="nt">---</span> <span class="o">[</span>           main] net.lipecki.demo.DemoApplication         : Started DemoApplication <span class="k">in </span>2.271 seconds <span class="o">(</span>JVM running <span class="k">for </span>2.643<span class="o">)</span>
</code></pre></div></div>

<p>i przetestowaÄ‡</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>curl http://localhost:8080/greeting <span class="o">&amp;&amp;</span> <span class="nb">echo
</span>Welcome!
</code></pre></div></div>

<h2 id="docelowa-struktura-projektu">Docelowa struktura projektu</h2>

<p>W przypadku najprostszego podejÅ›cia wystarczajÄ…ce byÅ‚oby dorzucenie tylko kodÃ³w czÄ™Å›ci webowej do aktualnego szkieletu i zadbania o jego poprawne budowanie. Jednak dla nas wystarczajÄ…ce to za maÅ‚o, od razu przygotujemy strukturÄ™ ktÃ³ra bÄ™dzie miaÅ‚a szansÄ™ wytrzymaÄ‡ prÃ³bÄ™ czasu.</p>

<p>Minimalny sensowny podziaÅ‚ to przygotowanie dwÃ³ch moduÅ‚Ã³w:</p>

<ul>
  <li>artefaktu wdroÅ¼eniowego z usÅ‚ugami REST,</li>
  <li>aplikacji webowej.</li>
</ul>

<p>Taki podziaÅ‚ aplikacja pozwala nam na dodatkowÄ… separacjÄ™ czÄ™Å›ci <em>backend</em> i <em>frontend</em> (w pogoni za ideaÅ‚em moÅ¼emy przygotowaÄ‡ jeszcze ciekawszÄ… strukturÄ™, szczegÃ³Å‚y w jednym z ostatnich akapitÃ³w wpisu).</p>

<p>W tym celu:</p>

<ul>
  <li>dodajemy do projektu dwa moduÅ‚y,
    <ul>
      <li>demo-app,</li>
      <li>demo-web,</li>
    </ul>
  </li>
  <li>przenosimy dotychczasowÄ… konfiguracjÄ™ budowania i kody do demo-app.</li>
</ul>

<p>CaÅ‚oÅ›Ä‡ zmian moÅ¼emy zweryfikowaÄ‡ w commicie do testowego repozytorium <em>GitHub</em>: <a href="https://github.com/glipecki/spring-with-angular-cli-demo/commit/2ee4efcdddf5c6f68e9191607a429f574f58e371">commit</a>.</p>

<p>Po tych zmianach, nadal moÅ¼emy budowaÄ‡ i uruchamiaÄ‡ aplikacjÄ™, jednak tym razem z poziomu moduÅ‚u demo-app.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>./mvnw clean package
 <span class="nb">.</span>
 <span class="nb">.</span>
 <span class="nb">.</span>
<span class="o">[</span>INFO] Reactor Summary:
<span class="o">[</span>INFO]
<span class="o">[</span>INFO] demo ............................................... SUCCESS <span class="o">[</span>  0.141 s]
<span class="o">[</span>INFO] demo-app ........................................... SUCCESS <span class="o">[</span>  4.909 s]
<span class="o">[</span>INFO] demo-web ........................................... SUCCESS <span class="o">[</span>  0.002 s]
<span class="o">[</span>INFO] <span class="nt">------------------------------------------------------------------------</span>
<span class="o">[</span>INFO] BUILD SUCCESS
<span class="o">[</span>INFO] <span class="nt">------------------------------------------------------------------------</span>
<span class="o">[</span>INFO] Total <span class="nb">time</span>: 5.329 s
<span class="o">[</span>INFO] Finished at: 2016-12-07T21:15:51+01:00
<span class="o">[</span>INFO] Final Memory: 30M/309M
<span class="o">[</span>INFO] <span class="nt">------------------------------------------------------------------------</span>

<span class="nv">$ </span>java <span class="nt">-jar</span> demo-app/target/demo-app-0.0.1-SNAPSHOT.jar
 <span class="nb">.</span>
 <span class="nb">.</span>
 <span class="nb">.</span>
2016-12-07 21:16:30.569  INFO 71306 <span class="nt">---</span> <span class="o">[</span>           main] s.b.c.e.t.TomcatEmbeddedServletContainer : Tomcat started on port<span class="o">(</span>s<span class="o">)</span>: 8080 <span class="o">(</span>http<span class="o">)</span>
2016-12-07 21:16:30.574  INFO 71306 <span class="nt">---</span> <span class="o">[</span>           main] net.lipecki.demo.DemoApplication         : Started DemoApplication <span class="k">in </span>2.732 seconds <span class="o">(</span>JVM running <span class="k">for </span>3.117<span class="o">)</span>
</code></pre></div></div>

<h2 id="dodanie-i-budownie-czÄ™Å›ci-web">Dodanie i budownie czÄ™Å›ci web</h2>

<p>Projekt czÄ™Å›ci webowej najÅ‚atwiej stworzyÄ‡ z wykorzystaniem Angular CLI, w tym celu wykonujemy:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">pwd</span>
/tmp/demo/demo-web/
<span class="nv">$ </span><span class="nb">rm</span> <span class="nt">-rf</span> src
<span class="nv">$ </span>ng init <span class="nt">--style</span><span class="o">=</span>scss
 <span class="nb">.</span>
 <span class="nb">.</span>
 <span class="nb">.</span>
Installing packages <span class="k">for </span>tooling via npm.
Installed packages <span class="k">for </span>tooling via npm.
</code></pre></div></div>

<p>Standardowy <em>Angular CLI</em> bÄ™dzie budowaÅ‚ aplikacjÄ™ do folderu <em>dist</em>. Jednak konwencja budowania przez <em>Maven</em> zakÅ‚ada, Å¼e wszystkie zasoby, czy to poÅ›rednie, czy docelowe, wygenerowane w trakcie procesu budowania trafiÄ… do odpowiednich podfolderÃ³w katalogu <em>target</em>. Preferowanie konwencji ponad konfiguracjÄ™ to zawsze dobry pomysÅ‚. W tym celu zmieniamy standardowÄ… konfiguracjÄ™ folderu budowania z <em>dist</em> na <em>target/webapp</em> w <em>angular-cli.json</em>: <a href="https://github.com/glipecki/spring-with-angular-cli-demo/commit/3edaecb08c40e93d5bf0c24da06f140ecefa0d74">commit</a>.</p>

<p>W tym momencie moÅ¼emy juÅ¼ swobodnie pracowaÄ‡ z aplikacjÄ… uruchamiajÄ…c jÄ… za pomocÄ… <em>ng serve</em>. Kolejnym krokiem bÄ™dzie zintegrowanie procesu budowania <em>ng build</em> z budowaniem moduÅ‚u <em>Maven</em>. W tym celu wykorzystamy plugin <em>frontend-maven-plugin</em>.</p>

<p>Plugin <em>frontend-maven-plugin</em> pozwala:</p>

<ul>
  <li>zainstalowaÄ‡ niezaleÅ¼nÄ… od systemowej wersjÄ™ <em>node</em> i <em>npm</em>,</li>
  <li>uruchomiÄ‡ instalacjÄ™ zaleÅ¼noÅ›ci <em>npm</em>,</li>
  <li>uruchomiÄ‡ budowanie aplikacji za pomocÄ… <em>ng</em>.</li>
</ul>

<p>CaÅ‚oÅ›Ä‡ konfiguracji wprowadzamy definiujÄ…c dodatkowe elementy <em>execution</em> konfiguracji pluginu.</p>

<p>Przed dodaniem konfiguracji poszczegÃ³lnych krokÃ³w dodajemy do sekcji <em>build.plugins</em> definicjÄ™ samego pluginu:</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;plugin&gt;</span>
  <span class="nt">&lt;groupId&gt;</span>com.github.eirslett<span class="nt">&lt;/groupId&gt;</span>
  <span class="nt">&lt;artifactId&gt;</span>frontend-maven-plugin<span class="nt">&lt;/artifactId&gt;</span>
  <span class="nt">&lt;version&gt;</span>1.3<span class="nt">&lt;/version&gt;</span>
  <span class="nt">&lt;configuration&gt;</span>
    <span class="nt">&lt;installDirectory&gt;</span>target<span class="nt">&lt;/installDirectory&gt;</span>
  <span class="nt">&lt;/configuration&gt;</span>
  <span class="nt">&lt;executions&gt;</span>
    <span class="c">&lt;!-- tutaj bÄ™dÄ… konfiguracje krokÃ³w budowaia --&gt;</span>
  <span class="nt">&lt;/executions&gt;</span>
<span class="nt">&lt;/plugin&gt;</span>
</code></pre></div></div>

<p>W pierwszym kroku instalujemy wskazanÄ… wersjÄ™ runtime <em>node</em> i menadÅ¼era pakietÃ³w <em>npm</em>. CaÅ‚oÅ›Ä‡ jest instalowana lokalnie w folderze <em>target</em>. DziÄ™ki lokalnej instalacji minimalizujemy listÄ™ wymagaÅ„ wstÄ™pnych do pracy z naszym projektem, co jest szczegÃ³lnie waÅ¼ne przy wykorzystaniu systemÃ³w <em>CI/CD</em>.</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;execution&gt;</span>
  <span class="nt">&lt;id&gt;</span>install node and npm<span class="nt">&lt;/id&gt;</span>
  <span class="nt">&lt;goals&gt;</span>
    <span class="nt">&lt;goal&gt;</span>install-node-and-npm<span class="nt">&lt;/goal&gt;</span>
  <span class="nt">&lt;/goals&gt;</span>
  <span class="nt">&lt;configuration&gt;</span>
    <span class="nt">&lt;nodeVersion&gt;</span>v6.9.1<span class="nt">&lt;/nodeVersion&gt;</span>
  <span class="nt">&lt;/configuration&gt;</span>
<span class="nt">&lt;/execution&gt;</span>
</code></pre></div></div>

<p>W drugim kroku plugin za pomocÄ… <em>npm</em> instaluje wszystkie zdefiniowane w <em>package.json</em> zaleÅ¼noÅ›ci naszego projektu. Jest to odpowiednik wykonania <em>npm install</em> w katalogu gÅ‚Ã³wnym projektu.</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;execution&gt;</span>
  <span class="nt">&lt;id&gt;</span>npm install<span class="nt">&lt;/id&gt;</span>
  <span class="nt">&lt;goals&gt;</span>
    <span class="nt">&lt;goal&gt;</span>npm<span class="nt">&lt;/goal&gt;</span>
  <span class="nt">&lt;/goals&gt;</span>
<span class="nt">&lt;/execution&gt;</span>
</code></pre></div></div>

<p>Ostatni krok to wykonanie wÅ‚aÅ›ciwego procesu budowania aplikacji z wykorzystaniem <em>Angular CLI</em>.</p>

<p>W celu uproszczenia konfiguracji dodajemy nowy task o nazwie <em>build</em> w pliku <em>package.json</em>. RÄ™czne zdefiniowanie taska jest o tyle waÅ¼ne, Å¼e w ten sposÃ³b bÄ™dziemy siÄ™ mogli uniezaleÅ¼niÄ‡ od systemowej instancji <em>Angular CLI</em> i stosowaÄ‡ lokalnÄ… wersjÄ™ zainstalowanÄ… na podstawie definicji w <em>package.json</em>.</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nl">"scripts"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="nl">"build"</span><span class="p">:</span><span class="w"> </span><span class="s2">"node node_modules/angular-cli/bin/ng build"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>Oraz dodajemy wykonanie nowo utworzonego tasku przez plugin.</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;execution&gt;</span>
  <span class="nt">&lt;id&gt;</span>node build app<span class="nt">&lt;/id&gt;</span>
  <span class="nt">&lt;phase&gt;</span>prepare-package<span class="nt">&lt;/phase&gt;</span>
  <span class="nt">&lt;goals&gt;</span>
    <span class="nt">&lt;goal&gt;</span>npm<span class="nt">&lt;/goal&gt;</span>
  <span class="nt">&lt;/goals&gt;</span>
  <span class="nt">&lt;configuration&gt;</span>
    <span class="nt">&lt;arguments&gt;</span>run-script build<span class="nt">&lt;/arguments&gt;</span>
  <span class="nt">&lt;/configuration&gt;</span>
<span class="nt">&lt;/execution&gt;</span>
</code></pre></div></div>

<blockquote>
  <p>Nazwa tasku <em>build</em> jest czysto umowna, jedyne wymaganie to uÅ¼ywanie tej samej w <em>package.json</em> i <em>pom.xml</em>. Jednak trzymanie siÄ™ konkretnej konwencji, np. build, uÅ‚atwi pracÄ™ pomiÄ™dzy rÃ³Å¼nymi projektami.</p>
</blockquote>

<p>Tak przygotowana konfiguracja pozwala zintegrowaÄ‡ budowanie aplikacji web z fazami cyklu Å¼ycia <em>Maven</em>. Dodatkowo dostajemy uspÃ³jniony sposÃ³b uruchomienia za pomocÄ… polecenia <em>npm build</em>. DziÄ™ki wykorzystaniu <em>frontend-maven-plugin</em> uniezaleÅ¼niamy proces budowania od Å›rodowiska, wszystkie wymagane biblioteki (<em>node</em>, <em>npm</em>, <em>angular-cli</em>) sÄ… instalowane i wykonywane lokalnie w folderze projektu.</p>

<p>CaÅ‚oÅ›Ä‡ zmian z tego kroku moÅ¼emy obejrzeÄ‡ w commicie <em>GitHub</em>: <a href="https://github.com/glipecki/spring-with-angular-cli-demo/commit/03f54e8ad670555e23f45d617b8642d7f8c48a64">commit</a>.</p>

<h2 id="skÅ‚adanie-artefaktu-z-czÄ™Å›ciÄ…-web">SkÅ‚adanie artefaktu z czÄ™Å›ciÄ… web</h2>

<p>Kolejnym krokiem jest umoÅ¼liwienie spakowania moduÅ‚u odpowiedzialnego za czÄ™Å›Ä‡ web do pojedynczego artefaktu, gotowego do wykorzystania jako zaleÅ¼noÅ›Ä‡ lub przesÅ‚ania do repozytorium artefaktÃ³w.</p>

<p>Standardowo <em>Maven</em> obsÅ‚uguje najpopularniejsze typy artefaktÃ³w, np. <em>jar</em>, <em>war</em>, <em>ear</em>. Dla tych typÃ³w znany jest sposÃ³b ich budowania, struktura archiwÃ³w jest odgÃ³rnie ustalona i niezmienna pomiÄ™dzy projektami. Jednak my chcemy przygotowaÄ‡ archiwum w postaci pliku <em>zip</em>, wiÄ™c wykorzystujÄ…c <em>maven-assembly-plugin</em> bÄ™dziemy mogli sami okreÅ›liÄ‡ jakie pliki i w jaki sposÃ³b zbieraÄ‡ budujÄ…c wynikowy artefakt.</p>

<p>Do <em>pom.xml</em> moduÅ‚u <em>demo-web</em> dodajemy definicjÄ™ <em>maven-assembly-plugin</em> zawierajÄ…cÄ… docelowÄ… nazwÄ™ artefaktu oraz plik assembly opisujÄ…cy sposÃ³b jego skÅ‚adania.</p>

<p>W sekcji <em>build.plugins</em> dopisujemy:</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;plugin&gt;</span>
  <span class="nt">&lt;groupId&gt;</span>org.apache.maven.plugins<span class="nt">&lt;/groupId&gt;</span>
  <span class="nt">&lt;artifactId&gt;</span>maven-assembly-plugin<span class="nt">&lt;/artifactId&gt;</span>
  <span class="nt">&lt;configuration&gt;</span>
    <span class="nt">&lt;descriptor&gt;</span>assembly.xml<span class="nt">&lt;/descriptor&gt;</span>
    <span class="nt">&lt;finalName&gt;</span>demo-web-${project.version}<span class="nt">&lt;/finalName&gt;</span>
    <span class="nt">&lt;appendAssemblyId&gt;</span>false<span class="nt">&lt;/appendAssemblyId&gt;</span>
  <span class="nt">&lt;/configuration&gt;</span>
  <span class="nt">&lt;executions&gt;</span>
    <span class="nt">&lt;execution&gt;</span>
      <span class="nt">&lt;phase&gt;</span>package<span class="nt">&lt;/phase&gt;</span>
      <span class="nt">&lt;goals&gt;</span>
        <span class="nt">&lt;goal&gt;</span>single<span class="nt">&lt;/goal&gt;</span>
      <span class="nt">&lt;/goals&gt;</span>
    <span class="nt">&lt;/execution&gt;</span>
  <span class="nt">&lt;/executions&gt;</span>
<span class="nt">&lt;/plugin&gt;</span>
</code></pre></div></div>

<p>NastÄ™pnie dodajemy plik <em>assembly.xml</em> (obok pliku <em>pom.xml</em>), w ktÃ³rym okreÅ›lamy docelowy format (<em>zip</em>) oraz ktÃ³re pliki, z ktÃ³rego katalogu spakowaÄ‡ do artefaktu (wszystkie z folder <em>target/webapp</em>).</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;assembly&gt;</span>
  <span class="nt">&lt;id&gt;</span>zip<span class="nt">&lt;/id&gt;</span>
  <span class="nt">&lt;formats&gt;</span>
    <span class="nt">&lt;format&gt;</span>zip<span class="nt">&lt;/format&gt;</span>
  <span class="nt">&lt;/formats&gt;</span>
  <span class="nt">&lt;includeBaseDirectory&gt;</span>false<span class="nt">&lt;/includeBaseDirectory&gt;</span>
  <span class="nt">&lt;fileSets&gt;</span>
    <span class="nt">&lt;fileSet&gt;</span>
      <span class="nt">&lt;directory&gt;</span>target/webapp<span class="nt">&lt;/directory&gt;</span>
      <span class="nt">&lt;outputDirectory&gt;&lt;/outputDirectory&gt;</span>
      <span class="nt">&lt;includes&gt;</span>
        <span class="nt">&lt;include&gt;</span>**<span class="nt">&lt;/include&gt;</span>
      <span class="nt">&lt;/includes&gt;</span>
    <span class="nt">&lt;/fileSet&gt;</span>
  <span class="nt">&lt;/fileSets&gt;</span>
<span class="nt">&lt;/assembly&gt;</span>
</code></pre></div></div>

<p>CaÅ‚oÅ›Ä‡ moÅ¼emy przetestowaÄ‡ wykonujÄ…c:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">pwd</span>
/tmp/demo
<span class="nv">$ </span>./mvnw clean package
 <span class="nb">.</span>
 <span class="nb">.</span>
 <span class="nb">.</span>
<span class="nv">$ </span><span class="nb">ls </span>demo-web/target/demo-web-0.0.1-SNAPSHOT.zip
demo-web/target/demo-web-0.0.1-SNAPSHOT.zip
</code></pre></div></div>

<p>Commit zawierajÄ…cy zmiany: <a href="https://github.com/glipecki/spring-with-angular-cli-demo/commit/6e0e6a99badc0ed27846c5a62316fe0ad31d77e4">commit</a>.</p>

<h2 id="skÅ‚adanie-artefaktu-wdroÅ¼eniowego">SkÅ‚adanie artefaktu wdroÅ¼eniowego</h2>

<p>Ostatnie co musimy zrobiÄ‡ Å¼eby nasza aplikacja skÅ‚adaÅ‚a siÄ™ w pojedynczy wykonywalny artefakt to skonfigurowaÄ‡ moduÅ‚ <em>demo-web</em> jako zaleÅ¼noÅ›Ä‡ w projekcie <em>demo-app</em> oraz skonfigurowanie pluginu <em>maven-dependency-plugin</em>, ktÃ³ry bÄ™dzie odpowiadaÅ‚ za odpowiednie rozpakowanie zasobÃ³w.</p>

<p>Definiujemy zaleÅ¼noÅ›Ä‡ na moduÅ‚ <em>demo-web</em> w <em>pom.xml</em> w sekcji <em>dependencies</em>:</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;dependency&gt;</span>
  <span class="nt">&lt;groupId&gt;</span>net.lipecki.demo<span class="nt">&lt;/groupId&gt;</span>
  <span class="nt">&lt;artifactId&gt;</span>demo-web<span class="nt">&lt;/artifactId&gt;</span>
  <span class="nt">&lt;version&gt;</span>${project.version}<span class="nt">&lt;/version&gt;</span>
  <span class="nt">&lt;type&gt;</span>zip<span class="nt">&lt;/type&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>
</code></pre></div></div>

<blockquote>
  <p>Standardowo <em>Maven</em> szuka zaleÅ¼noÅ›ci typu <em>jar</em>, jednak nasz moduÅ‚ <em>web</em> jest typu <em>zip</em>, co moÅ¼emy jawnie wskazaÄ‡ definiujÄ…c zaleÅ¼noÅ›Ä‡.</p>
</blockquote>

<p>Aplikacja Spring Boot poza serwowaniem zdefiniowany servletÃ³w i usÅ‚ug <em>REST</em> hostuje rÃ³wnieÅ¼ wszystkie zasoby, ktÃ³re znajdujÄ… siÄ™ na zdefiniowanych Å›cieÅ¼kach zasobÃ³w statycznych. W standardowej konfiguracji, jednÄ… z takich Å›cieÅ¼ek sÄ… zasoby wewnÄ…trz samego <em>jara</em> aplikacji. KorzystajÄ…c z tej wiedzy skonfigurujemy plugin <em>maven-dependency-plugin</em> w taki sposÃ³b, Å¼eby rozpakowywaÅ‚ archiwum moduÅ‚u <em>web</em> do odpowiedniego katalogu budowania.</p>

<p>W sekcji <em>build.plugins</em> dodajemy:</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;plugin&gt;</span>
  <span class="nt">&lt;groupId&gt;</span>org.apache.maven.plugins<span class="nt">&lt;/groupId&gt;</span>
  <span class="nt">&lt;artifactId&gt;</span>maven-dependency-plugin<span class="nt">&lt;/artifactId&gt;</span>
  <span class="nt">&lt;executions&gt;</span>
    <span class="nt">&lt;execution&gt;</span>
      <span class="nt">&lt;id&gt;</span>unpack<span class="nt">&lt;/id&gt;</span>
      <span class="nt">&lt;phase&gt;</span>generate-resources<span class="nt">&lt;/phase&gt;</span>
      <span class="nt">&lt;goals&gt;</span>
        <span class="nt">&lt;goal&gt;</span>unpack<span class="nt">&lt;/goal&gt;</span>
      <span class="nt">&lt;/goals&gt;</span>
      <span class="nt">&lt;configuration&gt;</span>
        <span class="nt">&lt;artifactItems&gt;</span>
          <span class="nt">&lt;artifactItem&gt;</span>
            <span class="nt">&lt;groupId&gt;</span>net.lipecki.demo<span class="nt">&lt;/groupId&gt;</span>
            <span class="nt">&lt;artifactId&gt;</span>demo-web<span class="nt">&lt;/artifactId&gt;</span>
            <span class="nt">&lt;version&gt;</span>${project.version}<span class="nt">&lt;/version&gt;</span>
            <span class="nt">&lt;type&gt;</span>zip<span class="nt">&lt;/type&gt;</span>
          <span class="nt">&lt;/artifactItem&gt;</span>
        <span class="nt">&lt;/artifactItems&gt;</span>
        <span class="nt">&lt;outputDirectory&gt;</span>${project.build.directory}/classes/resources<span class="nt">&lt;/outputDirectory&gt;</span>
      <span class="nt">&lt;/configuration&gt;</span>
    <span class="nt">&lt;/execution&gt;</span>
  <span class="nt">&lt;/executions&gt;</span>
<span class="nt">&lt;/plugin&gt;</span>
</code></pre></div></div>

<p>W tym momencie mamy juÅ¼ kompletny proces budowania aplikacji. Po jego wykonaniu i uruchomieniu aplikacji moÅ¼emy zarÃ³wno wywoÅ‚aÄ‡ testowÄ… usÅ‚ugÄ™ <em>REST</em>, jak i obejrzeÄ‡ szkielet <em>Angular 2</em>.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>./mvnw clean package
 <span class="nb">.</span>
 <span class="nb">.</span>
 <span class="nb">.</span>
<span class="o">[</span>INFO] <span class="nt">------------------------------------------------------------------------</span>
<span class="o">[</span>INFO] Reactor Summary:
<span class="o">[</span>INFO]
<span class="o">[</span>INFO] demo ............................................... SUCCESS <span class="o">[</span>  0.120 s]
<span class="o">[</span>INFO] demo-web ........................................... SUCCESS <span class="o">[</span> 18.459 s]
<span class="o">[</span>INFO] demo-app ........................................... SUCCESS <span class="o">[</span>  5.797 s]
<span class="o">[</span>INFO] <span class="nt">------------------------------------------------------------------------</span>
<span class="o">[</span>INFO] BUILD SUCCESS
<span class="o">[</span>INFO] <span class="nt">------------------------------------------------------------------------</span>
<span class="o">[</span>INFO] Total <span class="nb">time</span>: 24.644 s
<span class="o">[</span>INFO] Finished at: 2016-12-07T22:06:14+01:00
<span class="o">[</span>INFO] Final Memory: 37M/346M
<span class="o">[</span>INFO] <span class="nt">------------------------------------------------------------------------</span>

<span class="nv">$ </span>java <span class="nt">-jar</span> demo-app/target/demo-app-0.0.1-SNAPSHOT.jar
 <span class="nb">.</span>
 <span class="nb">.</span>
 <span class="nb">.</span>
2016-12-07 22:08:02.937  INFO 72316 <span class="nt">---</span> <span class="o">[</span>           main] s.b.c.e.t.TomcatEmbeddedServletContainer : Tomcat started on port<span class="o">(</span>s<span class="o">)</span>: 8080 <span class="o">(</span>http<span class="o">)</span>
2016-12-07 22:08:02.942  INFO 72316 <span class="nt">---</span> <span class="o">[</span>           main] net.lipecki.demo.DemoApplication         : Started DemoApplication <span class="k">in </span>2.681 seconds <span class="o">(</span>JVM running <span class="k">for </span>3.077<span class="o">)</span>

<span class="nv">$ </span>curl http://localhost:8080/greeting <span class="o">&amp;&amp;</span> <span class="nb">echo
</span>Welcome!

<span class="nv">$ </span>curl http://localhost:8080/
&lt;<span class="o">!</span>doctype html&gt;
&lt;html&gt;
&lt;<span class="nb">head</span><span class="o">&gt;</span>
  &lt;meta <span class="nv">charset</span><span class="o">=</span><span class="s2">"utf-8"</span><span class="o">&gt;</span>
  &lt;title&gt;DemoWeb&lt;/title&gt;
  &lt;base <span class="nv">href</span><span class="o">=</span><span class="s2">"/"</span><span class="o">&gt;</span>

  &lt;meta <span class="nv">name</span><span class="o">=</span><span class="s2">"viewport"</span> <span class="nv">content</span><span class="o">=</span><span class="s2">"width=device-width, initial-scale=1"</span><span class="o">&gt;</span>
  &lt;<span class="nb">link </span><span class="nv">rel</span><span class="o">=</span><span class="s2">"icon"</span> <span class="nb">type</span><span class="o">=</span><span class="s2">"image/x-icon"</span> <span class="nv">href</span><span class="o">=</span><span class="s2">"favicon.ico"</span><span class="o">&gt;</span>
&lt;/head&gt;
&lt;body&gt;
  &lt;app-root&gt;Loading...&lt;/app-root&gt;
&lt;script <span class="nb">type</span><span class="o">=</span><span class="s2">"text/javascript"</span> <span class="nv">src</span><span class="o">=</span><span class="s2">"inline.bundle.js"</span><span class="o">&gt;</span>&lt;/script&gt;&lt;script <span class="nb">type</span><span class="o">=</span><span class="s2">"text/javascript"</span> <span class="nv">src</span><span class="o">=</span><span class="s2">"styles.bundle.js"</span><span class="o">&gt;</span>&lt;/script&gt;&lt;script <span class="nb">type</span><span class="o">=</span><span class="s2">"text/javascript"</span> <span class="nv">src</span><span class="o">=</span><span class="s2">"vendor.bundle.js"</span><span class="o">&gt;</span>&lt;/script&gt;&lt;script <span class="nb">type</span><span class="o">=</span><span class="s2">"text/javascript"</span> <span class="nv">src</span><span class="o">=</span><span class="s2">"main.bundle.js"</span><span class="o">&gt;</span>&lt;/script&gt;&lt;/body&gt;
&lt;/html&gt;
</code></pre></div></div>

<p>Komplet dotychczasowych zmian moÅ¼emy podsumowaÄ‡ w repozytorium <em>GitHub</em>: <a href="https://github.com/glipecki/spring-with-angular-cli-demo/tree/4042649049dd65bf66e438779c0b8966d57d097f">repozytorium</a>.</p>

<h2 id="obsÅ‚uga-routingu-z-wykorzystaniem-historypushstate-html5-url-style">ObsÅ‚uga routingu z wykorzystaniem history.pushState (html5 url style)</h2>

<p>Poza samym budowaniem i uruchamianiem aplikacji, warto jeszcze zadbaÄ‡ o wsparcie dla nowych sposobÃ³w nawigacji. CaÅ‚oÅ›Ä‡ moÅ¼na Å‚atwo zrealizowaÄ‡ wykorzystujÄ…c mechanizmy generowania stron bÅ‚Ä™dÃ³w w <em>Springu</em>. Zanim przejdziemy do kodu, kilka sÅ‚Ã³w wprowadzenia teoretycznego.</p>

<p>Dotychczas aplikacje web moÅ¼na byÅ‚o Å‚atwo rozpoznaÄ‡ po routingu opartym o #â€¦ w url. Taki sposÃ³b nawigacji nie narzuca Å¼adnych ograniczeÅ„ na stronÄ™ serwerowÄ… aplikacji, jednak tworzy kilka niemoÅ¼liwych do rozwiÄ…zania problemÃ³w, np. renderowanie po stronie serwerowej, czy wsparcie dla SEO.</p>

<p>Obecnie, wiÄ™kszoÅ›Ä‡ nowoczesnych przeglÄ…darek dostarcza nowe <em>API</em> <em>history.pushState</em> pozwalajÄ…ce zrealizowaÄ‡ nawigacjÄ™ z pominiÄ™ciem znaku #. Po szczegÃ³Å‚y odsyÅ‚am do oficjalnej dokumentacji <em>Angular</em>, natomiast w kolejnych akapitach zajmiemy siÄ™ konfiguracjÄ… Spring Boot wspierajÄ…cÄ… tÄ™ strategiÄ™.</p>

<p>CaÅ‚oÅ›Ä‡ jest o tyle waÅ¼na, Å¼e nawigacja bez <em>#</em> jest zalecanÄ… przez zespÃ³Å‚ <em>Angular 2</em> konfiguracjÄ…. Przez to jest stosowana zarÃ³wna w dokumentacji, oficjalnym guide oraz wszystkich szablonach projektÃ³w, w tym rÃ³wnieÅ¼ <em>Angular CLI</em>. To jednak oznacza, Å¼e do serwera usÅ‚ug bÄ™dÄ… generowane Å¼Ä…dania oparte o Å›cieÅ¼ki, ktÃ³re fizycznie nie sÄ… nigdzie zdefiniowane, co zakoÅ„czy siÄ™ bÅ‚Ä™dami 404. <strong>W tej sytuacji, bez dostosowania naszego projektu, nie bÄ™dziemy w stanie w ogÃ³le uruchomiÄ‡ aplikacji oferujÄ…cej nawigacjÄ™ opartÄ… o routing.</strong></p>

<p>W zaÅ‚oÅ¼eniu przedstawiony problem moÅ¼emy uproÅ›ciÄ‡ do zwracania treÅ›ci <em>index.html</em> zawsze wtedy, kiedy standardowo zwrÃ³cilibyÅ›my bÅ‚Ä…d <em>404</em>. RozwiÄ…zanie powinno uwzglÄ™dniaÄ‡ zarÃ³wno istnienie zdefiniowanych w aplikacji mapowaÅ„, jak i pobieranie zasobÃ³w dostÄ™pnych w lokalizacjach zasobÃ³w statycznych.</p>

<p>Najprostszym rozwiÄ…zaniem jest zdefiniowanie wÅ‚asnego <em>ErrorViewResolver</em>, ktÃ³ry dla bÅ‚Ä™dÃ³w <em>404</em> wykona przekierowanie na zasÃ³b <em>/index.html</em>.</p>

<p>W tym celu dodajemy do kontekstu beana <em>customErrorViewResolver</em>, ktÃ³ry wszystkie Å¼Ä…dania standardowo zwracajÄ…c <em>HttpStatus.NOT_FOUND</em> przekieruje na <em>index.html</em>.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Bean</span>
<span class="kd">public</span> <span class="nc">ErrorViewResolver</span> <span class="nf">customErrorViewResolver</span><span class="o">()</span> <span class="o">{</span>
  <span class="kd">final</span> <span class="nc">ModelAndView</span> <span class="n">redirectToIndexHtml</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ModelAndView</span><span class="o">(</span><span class="s">"forward:/index.html"</span><span class="o">,</span> <span class="nc">Collections</span><span class="o">.</span><span class="na">emptyMap</span><span class="o">(),</span> <span class="nc">HttpStatus</span><span class="o">.</span><span class="na">OK</span><span class="o">);</span>
    <span class="k">return</span> <span class="o">(</span><span class="n">request</span><span class="o">,</span> <span class="n">status</span><span class="o">,</span> <span class="n">model</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="n">status</span> <span class="o">==</span> <span class="nc">HttpStatus</span><span class="o">.</span><span class="na">NOT_FOUND</span> <span class="o">?</span> <span class="n">redirectToIndexHtml</span> <span class="o">:</span> <span class="kc">null</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div>

<p><em>Przy takim podejÅ›ciu warto zadbaÄ‡ o to, Å¼eby zawsze jakiÅ› index.html mÃ³gÅ‚ siÄ™ rozwiÄ…zaÄ‡!</em></p>

<p>SposÃ³b wprowadzenia zmiany moÅ¼na przeÅ›ledziÄ‡ w commicie GitHub: <a href="https://github.com/glipecki/spring-with-angular-cli-demo/commit/57149a404989fc44a012628f4506b7c556d4b36d">57149a4</a>.</p>

<p>Wykorzystanie wÅ‚asnego <em>ErrorViewResolver</em> dodatkowo zapewnia nam wsparcie dla rozrÃ³Å¼niania Å¼Ä…daÅ„ na podstawie nagÅ‚Ã³wka <em>HTTP</em> <em>produces</em>. To znaczy, Å¼e Å¼Ä…dania z przeglÄ…darek (zawierajÄ…ce produces = â€œtext/htmlâ€) zostanÄ… obsÅ‚uÅ¼one zawartoÅ›ciÄ… zasobu <em>/index.html</em>, natomiast pozostaÅ‚e (np. curl) odpowiedzÄ… standardowym bÅ‚Ä™dem <em>404</em>.</p>

<h2 id="moÅ¼liwe-rozszerzenia">MoÅ¼liwe rozszerzenia</h2>

<p>Wartym rozwaÅ¼enia rozszerzeniem projektu moÅ¼e byÄ‡ wydzielenie trzeciego moduÅ‚u i dodatkowe podzielenie aplikacji:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>demo
\-- demo-rest
\-- demo-app
\-- demo-web
</code></pre></div></div>

<p>Gdzie moduÅ‚y:</p>

<ul>
  <li>demo-web - zawiera zasoby aplikacji web,</li>
  <li>demo-rest - zawiera samodzielnie uruchamialnÄ… aplikacjÄ™ dostarczajÄ…cÄ… komplet usÅ‚ug <em>REST</em>,</li>
  <li>demo-app - jest zÅ‚Ä…czeniem moduÅ‚Ã³w web i rest w jeden wykonywalny artefakt.</li>
</ul>

<p>Przy takim podziale uzyskujemy duÅ¼Ä… separacjÄ™ pomiÄ™dzy moduÅ‚ami. CzÄ™Å›Ä‡ <em>backend</em> odpowiedzialna ze udostÄ™pnienie usÅ‚ug <em>REST</em> i jest caÅ‚kowicie niezaleÅ¼na od moduÅ‚u <em>demo-web</em>. ModuÅ‚ <em>demo-web</em> takÅ¼e nie ma Å¼adnej zaleÅ¼noÅ›ci. To oznacza, Å¼e moÅ¼emy je rozwijaÄ‡, wersjonowaÄ‡ oraz osadzaÄ‡ rozdzielnie. Dodatkowo wprowadzenie moduÅ‚u <em>app</em> pozwala pisaÄ‡ usÅ‚ugi <em>REST</em> w oderwaniu od produkcyjnego osadzania, np. moÅ¼liwe jest lokalne uruchamianie moduÅ‚u <em>demo-rest</em> jako <em>fat jar</em> z <em>Jetty</em>, podczas gdy produkcyjnie moduÅ‚ <em>demo-app</em> bÄ™dzie osadzany jako <em>war</em> na <em>Tomcat</em>.</p>

<h2 id="codzienna-praca-z-aplikacjÄ…">Codzienna praca z aplikacjÄ…</h2>

<p>PeÅ‚niÄ™ moÅ¼liwoÅ›ci duetu Spring Boot i Angular CLI poczujemy dopiero odpowiednio przygotowujÄ…c Å›rodowisko codziennej pracy.</p>

<p>CzÄ™Å›Ä‡ klienckÄ… uruchamiamy przez <em>ng serve</em>, dziÄ™ki temu dostajemy kompilacjÄ™ i budowanie aplikacji po kaÅ¼dej zmianie kodÃ³w ÅºrÃ³dÅ‚owych oraz dodatkowo powiadomienia <em>live reload</em> i odÅ›wieÅ¼anie aplikacji w przeglÄ…darce. CzÄ™Å›Ä‡ serwerowÄ… uruchamiamy w <em>IDE</em> wspierajÄ…cym <em>hot swap</em> kodÃ³w.</p>

<p>Przy takiej konfiguracji aplikacja webowa jest dostÄ™pna na porcie <em>4200</em>, a backend <em>REST</em> na porcie <em>8080</em>. Musimy jeszcze umoÅ¼liwiÄ‡ dostÄ™p do usÅ‚ug <em>REST</em> w sposÃ³b identyczny z docelowym, w tym celu na porcie <em>4200</em> skonfigurujemy proxy do usÅ‚ug.</p>

<p>Dla wygody konfiguracji przenosimy wystawione usÅ‚ugi pod prefix <em>/api</em> i tworzymy plik mapowaÅ„ proxy w <em>demo-web/proxy.conf.json</em>:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"/api"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"target"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://localhost:8080"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"secure"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p><em>We wszystkich zdefiniowanych adnotacjach @RequestMapping dopisaÅ‚em prefix /api w mapowanym url.</em></p>

<p>CzÄ™Å›Ä‡ serwerowÄ… uruchamiamy w <em>IDE</em> (lub dowolny inny sposobÃ³w), natomiast czÄ™Å›Ä‡ web uruchamiamy przez <em>Angular CLI</em>:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>ng serve <span class="nt">--proxy-config</span> proxy.conf.json
 <span class="nb">.</span>
 <span class="nb">.</span>
 <span class="nb">.</span>
webpack: bundle is now VALID.
<span class="nv">$ </span>curl http://localhost:8080/api/greeting <span class="o">&amp;&amp;</span> <span class="nb">echo
</span>Welcome!
<span class="nv">$ </span>curl http://localhost:4200/api/greeting <span class="o">&amp;&amp;</span> <span class="nb">echo
</span>Welcome!
</code></pre></div></div>

<p>Dodakowo konfiguracjÄ™ uruchomienia wspierajÄ…cÄ… proxy usÅ‚ug warto zdefiniowaÄ‡ w pliku <em>package.json</em>, w sekcji <em>scripts</em> modyfikujemy polecenie skrypt <em>start</em>:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nl">"scripts"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="nl">"start"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ng serve --proxy-config proxy.conf.json"</span><span class="p">,</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>DziÄ™ki temu nie musimy pamiÄ™taÄ‡ przeÅ‚Ä…czikÃ³w i parametrÃ³w, a caÅ‚oÅ›Ä‡ moÅ¼emy uruchamiaÄ‡ jednym poleceniem:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>npm start
 <span class="nb">.</span>
 <span class="nb">.</span>
 <span class="nb">.</span>
webpack: bundle is now VALID.
</code></pre></div></div>

<p>W ten sposÃ³b pracujemy z aplikacjÄ… wystawionÄ… pod adresem http://localhost:4200/, a wszystkie zmiany w czÄ™Å›ci serwerowej i webowej moÅ¼emy mieÄ‡ odÅ›wieÅ¼ane na bieÅ¼Ä…co, zaraz po ich wprowadzeniu.</p>

<p><a href="https://github.com/glipecki/spring-with-angular-cli-demo/commit/e1e66fe641a33d061227dd47e53a6f83c442f72f">Commit opisujÄ…cy wprowadzone zmiany.</a></p>

<h2 id="podsumowanie">Podsumowanie</h2>

<p>JeÅ¼eli na co dzieÅ„ pracujesz z projektami opartymi o <em>Spring Boot</em> i <em>Maven</em> ich integracja z aplikacjami pisanymi w <em>Angular CLI</em> nie bÄ™dzie stanowiÄ‡ duÅ¼ego wyzwania. W podstawowej realizacji pomoÅ¼e Ci plugin <em>maven-frontend-plugin</em>, natomiast wykorzystujÄ…c dodatkowo <em>maven-assembly-plugin</em> i <em>maven-dependency-plugin</em> moÅ¼liwe jest przygotowanie duÅ¼o bardziej zÅ‚oÅ¼onych procesÃ³w budowania aplikacji.</p>

<p>OstatecznÄ… wersjÄ™ aplikacji moÅ¼emy obejrzeÄ‡ na GitHub: <a href="https://github.com/glipecki/spring-with-angular-cli-demo">demo@github</a>.</p>

<p><em>Na sam koniec chciaÅ‚bym podziÄ™kowaÄ‡ <strong>Krysi</strong>, <strong>Jackowi</strong> i <strong>Marcinowi</strong>. Bez Was nie byÅ‚oby tego wpisu, dziÄ™ki!</em></p>

<h2 id="materiaÅ‚y">MateriaÅ‚y</h2>
<ul>
  <li><a href="https://github.com/glipecki/spring-with-angular-cli-demo">https://github.com/glipecki/spring-with-angular-cli-demo</a></li>
  <li><a href="http://www.consdata.pl/blog/7-szybki-start-z-angular-cli">http://www.consdata.pl/blog/7-szybki-start-z-angular-cli</a></li>
  <li><a href="https://angular.io/docs/ts/latest/guide/router.html#!#browser-url-styles">https://angular.io/docs/ts/latest/guide/router.html#!#browser-url-styles</a></li>
  <li><a href="http://docs.spring.io/spring-boot/docs/current-SNAPSHOT/reference/htmlsingle/#common-application-properties">http://docs.spring.io/spring-boot/docs/current-SNAPSHOT/reference/htmlsingle/#common-application-properties</a></li>
</ul>
:ET