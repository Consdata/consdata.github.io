<!DOCTYPE html>
<html lang="en">
<script src="/js/lunr.min.js"></script><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Zarządzanie stanem aplikacji frontendowej na przykładzie NgRx | Consdata - blog techniczny</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="Zarządzanie stanem aplikacji frontendowej na przykładzie NgRx" />
<meta name="author" content="mchrapkowicz" />
<meta property="og:locale" content="pl" />
<meta name="description" content="W miarę rozwijania złożonych aplikacji webowych ważnym i nieoczywistym zagadnieniem staje się projektowanie przepływu informacji pomiędzy komponentami. W tym artykule poznamy jedną z implementacji architektury Redux wykorzystującej koncepcję globalnego stanu aplikacji oraz pokażemy przykład jej zastosowania w bibliotece NgRx." />
<meta property="og:description" content="W miarę rozwijania złożonych aplikacji webowych ważnym i nieoczywistym zagadnieniem staje się projektowanie przepływu informacji pomiędzy komponentami. W tym artykule poznamy jedną z implementacji architektury Redux wykorzystującej koncepcję globalnego stanu aplikacji oraz pokażemy przykład jej zastosowania w bibliotece NgRx." />
<link rel="canonical" href="https://blog.consdata.tech/en/2021/10/13/zarzadzanie-stanem-aplikacji-frontendowej.html" />
<meta property="og:url" content="https://blog.consdata.tech/2021/10/13/zarzadzanie-stanem-aplikacji-frontendowej.html" />
<meta property="og:site_name" content="Consdata - blog techniczny" />
<meta property="og:image" content="https://blog.consdata.tech/assets/img/posts/2021-09-31-zarzadzanie-stanem-aplikacji-frontendowej/thumbnail.webp" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-10-13T00:00:00-05:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="https://blog.consdata.tech/assets/img/posts/2021-09-31-zarzadzanie-stanem-aplikacji-frontendowej/thumbnail.webp" />
<meta property="twitter:title" content="Zarządzanie stanem aplikacji frontendowej na przykładzie NgRx" />
<script type="application/ld+json">
{"author":{"@type":"Person","name":"mchrapkowicz"},"image":"https://blog.consdata.tech/assets/img/posts/2021-09-31-zarzadzanie-stanem-aplikacji-frontendowej/thumbnail.webp","@type":"BlogPosting","headline":"Zarządzanie stanem aplikacji frontendowej na przykładzie NgRx","description":"W miarę rozwijania złożonych aplikacji webowych ważnym i nieoczywistym zagadnieniem staje się projektowanie przepływu informacji pomiędzy komponentami. W tym artykule poznamy jedną z implementacji architektury Redux wykorzystującej koncepcję globalnego stanu aplikacji oraz pokażemy przykład jej zastosowania w bibliotece NgRx.","dateModified":"2021-10-13T00:00:00-05:00","datePublished":"2021-10-13T00:00:00-05:00","url":"https://blog.consdata.tech/2021/10/13/zarzadzanie-stanem-aplikacji-frontendowej.html","mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.consdata.tech/2021/10/13/zarzadzanie-stanem-aplikacji-frontendowej.html"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css?family=Raleway:400,700,600,500,300,200,100,800,900" rel="stylesheet" type="text/css">
  <link href="https://fonts.googleapis.com/css?family=Ubuntu+Mono:400,700,600,500,300,200,100,800,900" rel="stylesheet" type="text/css">
  <link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@100;400;500;700&display=swap" rel="stylesheet">
  <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" crossorigin="anonymous">
  <link rel="stylesheet" href="/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://blog.consdata.tech/en/feed.xml" title="Consdata - blog techniczny" /><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-NFV6DPR');</script>


  <link rel="icon" type="image/x-icon" href="/en/favicon.ico">
</head>
<body><nav class="site-header">
    <div class="container">
        <div class="header navbar-default" role="navigation">
            <div class="header-brand">
                <a class="header-logo" href="/en/">
                    <img src="/assets/img/logo.png" alt="consdata.com">
                </a>
                <div class="mobile-search">
                    
<form action="/en/search.html" method="get">

    <div class="search-input-container">
        <input type="text" placeholder="Find an article..." id="search-box-mobile" name="query" class="search-input" autocomplete="off">
        <i class="fa fa-search search-icon" onclick="expandInputMobile()"></i>
    </div>
</form>

<script>
    const inputMobile = document.getElementById("search-box-mobile");
    const logo = document.getElementById("header-logo");
    const expandInputMobile = () => {
        inputMobile.classList.toggle("expanded");
        logo.classList.toggle("header-logo");
        logo.classList.toggle("logo-invisible");
    };
</script>

                </div>
            </div>
            <div id="header-links">
                <div>
                    <a class="nav-link" href="/en/">Technical blog</a>
                    <a class="nav-link" href="https://consdata.com/pl/blog/biznesowy">Business blog</a>
                    <a class="nav-link" href="https://consdata.com/pl/blog/hr">HR department</a>
                </div>
                
                <a class="language-switch" onclick="navigate(' /2021/10/13/zarzadzanie-stanem-aplikacji-frontendowej.html')">PL</a>
                
            </div>

        </div>
    </div>
</nav>
<script>
    function navigate(baseUrl) {
        const queryParams = window.location.search;
        window.location.href = baseUrl + queryParams;
    }
</script>
<main class="page-content" aria-label="Content">
    


<div class="blog">
    <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">
        <div class="post-content-sidebar">
            <div class="post-content">
                <div class="badge">frontend</div>
                <h1 class="post-big-title p-name" itemprop="name headline">Zarządzanie stanem aplikacji frontendowej na przykładzie NgRx</h1>
                <div class="post-metadata">
    <div>
    <a class="author" href="/en/authors/mchrapkowicz.html">
        <img class="author-image" src="/assets/img/authors/mchrapkowicz.webp" alt="author">
        <span class="author-name">Marcin Chrapkowicz</span><a class="author" href="https://github.com/Chrrapek">
            <img class="github-icon" src="/assets/icon/github.svg">
        </a>
        
    </a>
</div>

    <div class="metadata">
        
        <span class="publish-date">
13


October


2021
</span>
    </div>
</div>

                <div itemprop="articleBody" class="post-content-container">
                    <div class="post-content-left-pane">
                        <div class="post-content">
                            <p>W miarę rozwijania złożonych aplikacji webowych ważnym i nieoczywistym zagadnieniem staje się projektowanie przepływu informacji pomiędzy komponentami. Często mamy do czynienia z wieloma źródłami danych. Mogą to być na przykład najróżniejsze zewnętrzne serwisy czy interakcje użytkownika z systemem. Nierzadko dane z tych źródeł potrzebne są w różnych obszarach aplikacji, wpływają na wiele aspektów jej działania czy wyglądu. W związku z powyższym muszą zostać rozpropagowane do miejsc, w których zostaną użyte. Można się jednak zastanowić, czy “przepychanie” parametrów po całej aplikacji jest szczytem naszych możliwości. W przypadku rozbudowanych projektów jest to dość żmudne zadanie, a w efekcie bardzo szybko może zabałaganić nasz kod, pomieszać orkiestrację z prezentacją, nie wspominając już o wprowadzeniu trudności w testowaniu logiki opartej o przekazywane dane.</p>

<p>Jeden z pomysłów adresujących między innymi powyższe problemy wygląda następująco:</p>
<ul>
  <li>stwórzmy dostępne tylko do odczytu, pojedyncze źródło danych wejściowych,</li>
  <li>wyraźnie rozgraniczmy logikę aplikacji od jej prezentacji,</li>
  <li>sprawmy, żeby dane wynikały z historii pewnych zdarzeń zachodzących w aplikacji,</li>
  <li>nie przechowujmy danych, które mogą zostać wyliczone na podstawie już przechowywanych - ewaluujmy je w locie.</li>
</ul>

<p>Te i kilka innych koncepcji zebrano i wymyślono w ten sposób architekturę zwaną Redux. Mając na uwadze problem, który chcemy rozwiązać oraz ogólny zarys rozwiązania, postaram się przedstawić jej składowe oraz implementację w bibliotece NgRx.</p>

<h3 id="czy-na-pewno-potrzebujesz-zarządzania-stanem-aplikacji">Czy na pewno potrzebujesz zarządzania stanem aplikacji?</h3>
<p>Zanim zaczniemy, zwróćmy uwagę, że nie każda aplikacja jest tak rozbudowana i złożona, żeby potrzebować całego mechanizmu zarządzania stanem. Jeśli “przepychanie parametrów” odbywa się pomiędzy niewielką liczbą komponentów, to nie musimy wytaczać przysłowiowych armat, żeby ustrzelić komara. W ustaleniu, czy dobrze byłoby sobie pomóc zewnętrznym rozwiązaniem, pomaga zasada SHARI zaprezentowana, chociażby, w <a href="https://ngrx.io/guide/store/why">oficjalnej dokumentacji NgRx</a>. Warto sobie odpowiedzieć, czy potrzebujemy stanu, który jest:</p>
<ul>
  <li><strong>S</strong>hared - współdzielony pomiędzy wiele komponentów i serwisów.</li>
  <li><strong>H</strong>ydrated - trwały i z możliwością ponownego zasilenia z zewnętrznego źródła jak np. local storage.</li>
  <li><strong>A</strong>vailable - dostępny cały czas, niezależnie od sposobu nawigacji po aplikacji, np. podczas przechodzenia i cofania się w aplikacji prezentującej złożony wniosek.</li>
  <li><strong>R</strong>etrieved - zdolny do przechowywania danych pochodzących z zewnętrznych źródeł, co pozwala na przykład zapisać wynik żądania HTTP i nie wykonywać go po raz kolejny w celu otrzymania tych samych informacji.</li>
  <li><strong>I</strong>mpacted - zdolny do zmieniania się pod wpływem akcji wykonywanych przez komponenty i serwisy.</li>
</ul>

<h2 id="architektura-redux">Architektura Redux</h2>
<p>Spójrzmy zatem co tak naprawdę kryje się pod tym, być może na razie dość enigmatycznym, pojęciem “Redux”. Posłużę się tutaj obrazkiem zaczerpniętym z dokumentacji NgRx.</p>

<p><img src="/assets/img/posts/2021-09-31-zarzadzanie-stanem-aplikacji-frontendowej/redux.png" alt="Redux" />
<span class="img-legend">Architektura Redux z lotu ptaka. Źródło: dokumentacja NgRx</span></p>

<p>Na razie powyższy diagram może wydawać się nieco tajemniczy. Dla bardziej zaprawionych w bojach po stronie backendowej może się skojarzyć z CQRS. Niemniej już spieszę z wyjaśnieniami.</p>

<ul>
  <li>Architektura Redux zakłada istnienie globalnego, niemutowalnego bytu, przechowującego stan aplikacji - <strong>store</strong>. Fizycznie jest to obiekt w formacie JSON, którego struktura definiowana jest przez programistę.</li>
  <li>Podstawowym mechanizmem komunikacji są <strong>akcje</strong> (ang. <em>actions</em>). Reprezentują one konkretne zdarzenia zachodzące w systemie i niosą ze sobą określone informacje.</li>
  <li>Akcje mogą być przechwytywane przez <strong>reducery</strong> (ang. <em>reducers</em>). Reducerem nazywamy czystą funkcję (ang. <em>pure function</em>), która konsumuje akcję i, w zależności od jej przeznaczenia oraz zgodnie z logiką reducera, zastępuje store nowym, z uwzględnioną zmianą.</li>
  <li>Dane ze store do komponentów trafiają poprzez <strong>selektory</strong> (ang. <em>selectors</em>). Selektory powinny otrzymywać wyłącznie dane potrzebne do działania komponentów, w których są używane.</li>
  <li>W przypadkach, kiedy wywołanie akcji powinno pociągnąć za sobą dowolne działanie niezwiązane bezpośrednio z aplikacją (np. zapytanie do bazy danych, czy żądanie do zewnętrznej usługi) - do gry wchodzi <strong>middleware</strong>, które dalej, ze względu na nomenklaturę stosowaną w NgRx, nazywać będziemy <strong>efektami</strong> (ang. <em>effects</em>). Podobnie jak reducery, middleware potrafi reagować na konkretne akcje i wykonać przypisane im zadanie, jak również wywołać kolejne akcje.</li>
</ul>

<h2 id="implementacja-redux-w-ngrx">Implementacja Redux w NgRx</h2>
<p>Przy pierwszym kontakcie wszystkie powyższe pojęcia i pomysły mogą wydawać się nieco skomplikowane i nadmiarowe, zatem na prostym przykładzie pokażę, jak wyglądają fragmenty aplikacji pisanej przy pomocy NgRx. Na końcu wpisu znajduje się link do repozytorium, w którym widać, jak wygląda cała aplikacja oraz jej konfiguracja. Również z tego powodu pomijam instrukcje instalacji biblioteki i konfiguracji środowiska.</p>

<p>Załóżmy, że chcemy stworzyć prosty program pozwalający na zapisywanie sposobów na pokonanie nudy. Jednym z możliwych do podjęcia działań będzie wywołanie API, które na każde żądanie odpowie pomysłem na jakąś aktywność. Drugą opcją będzie dodanie własnej koncepcji poprzez prosty formularz. Zacznijmy zatem.</p>

<h3 id="store">Store</h3>
<p>Na samym początku procesu, warto uzmysłowić sobie, co tak naprawdę chcemy zapisywać w naszym store, a potem powiedzieć to Typescriptowi tworząc interfejs. W naszej aplikacji będziemy przechowywali w nim jedynie listę czynności potencjalnie zabijających nudę, jednak nawet w tak prostym przypadku warto zwrócić uwagę na to, jaką strukturę planujemy nadać store’owi. Początkowo najprościej jest operować na płaskiej strukturze, w której wszystkie dane znajdują się na tym samym poziomie.
Niestety przy rozwijaniu aplikacji takie podejście staje się bardzo nieefektywne, zarówno pod względem organizacji, jak i, z czasem, również wydajności. Zdecydowanie lepiej jest podzielić store na tak zwane “slice’y”, czyli wycinki danych, na przykład dzieląc store według funkcjonalności aplikacji. Zobaczmy takie podejście na przykładzie:</p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">export</span> <span class="kr">interface</span> <span class="nx">State</span> <span class="p">{</span>
    <span class="nl">activitiesState</span><span class="p">:</span> <span class="nx">ActivityItemsState</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">export</span> <span class="kr">interface</span> <span class="nx">ActivityItemsState</span> <span class="p">{</span>
    <span class="nl">activities</span><span class="p">:</span> <span class="nx">ActivityItemModel</span><span class="p">[];</span>
<span class="p">}</span>

<span class="k">export</span> <span class="kr">interface</span> <span class="nx">ActivityItemModel</span> <span class="p">{</span>
    <span class="nl">name</span><span class="p">:</span> <span class="kr">string</span><span class="p">;</span>
    <span class="nl">participants</span><span class="p">:</span> <span class="kr">number</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Przejdźmy po powyższych interfejsach po kolei. Pierwszy z nich mówi, że spodziewamy się mieć jeden wycinek danych (slice) typu <code class="language-plaintext highlighter-rouge">ActivityItemsState</code>, w którym będą przechowywane wszystkie informacje dotyczące aktywności dodanych do aplikacji. Innymi słowy jest to logicznie wydzielony fragment domeny. Następnie definiujemy, co tak naprawdę znajduje się w tym wycinku danych - jest to tablica obiektów typu <code class="language-plaintext highlighter-rouge">ActivityItemModel</code>, czyli informacji o różnych aktywnościach. Ostatni interfejs to już wyłącznie definicja modelu biznesowego - w naszej aplikacji będziemy mieli do czynienia z nazwą czynności oraz możliwą liczbą jej uczestników.</p>

<p>Taki podział store zapewnia bardzo łatwą jego rozszerzalność, gdyż w przypadku dodania nowej funkcjonalności wystarczy dopisać nowy wycinek danych do store. W bardzo dużych aplikacjach, gdzie obiekt stanu aplikacji jest już dość potężny, to podejście ma jeszcze jedną zaletę - pozwala wykorzystać <em>lazy loading</em>, to znaczy wczytywać tylko konkretne wycinki store, potrzebne do aktualnie przetwarzanej części aplikacji.</p>

<h3 id="akcje">Akcje</h3>
<p>Potrzebujemy teraz opcji wywoływania akcji, żeby móc zgłaszać zajście pewnych faktów w systemie. W naszej aplikacji zakładamy możliwość wystąpienia dwóch zdarzeń - wystosowania żądania do API po pomysł na jakieś zajęcie oraz dodania aktywności do listy.</p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">export</span> <span class="kd">const</span> <span class="nx">activityAddedType</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">[activity] Activity added</span><span class="dl">'</span><span class="p">;</span>
<span class="k">export</span> <span class="kd">const</span> <span class="nx">activitiesRetrievedType</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">[activity] Activities retrieved</span><span class="dl">'</span><span class="p">;</span>

<span class="k">export</span> <span class="kd">const</span> <span class="nx">activityAdded</span> <span class="o">=</span> <span class="nx">createAction</span><span class="p">(</span><span class="nx">activityAddedType</span><span class="p">,</span> <span class="nx">props</span><span class="o">&lt;</span><span class="nx">ActivityItemModel</span><span class="o">&gt;</span><span class="p">());</span>
<span class="k">export</span> <span class="kd">const</span> <span class="nx">activitiesRetrieved</span> <span class="o">=</span> <span class="nx">createAction</span><span class="p">(</span><span class="nx">activitiesRetrievedType</span><span class="p">);</span>
</code></pre></div></div>

<p>Każda akcja musi mieć zdefiniowany swój typ. NgRx używa do tego tzw. <em>literal type</em>, czyli po prostu używa typu string do identyfikacji akcji (u nas odpowiednio <code class="language-plaintext highlighter-rouge">[activity] Activity added</code> oraz <code class="language-plaintext highlighter-rouge">[activity] Activities retrieved</code>). W nazywaniu akcji mamy pełną dowolność. Dodatkowo w przypadku dodawania nowej aktywności do listy musimy ją przekazać w ciele akcji przy pomocy metody <code class="language-plaintext highlighter-rouge">props&lt;&gt;()</code>. Dzięki wykorzystaniu funkcji <code class="language-plaintext highlighter-rouge">createAction</code> z biblioteki NgRx tworzenie akcji, jak widać, jest bardzo proste.</p>

<h3 id="efekt">Efekt</h3>
<p>Jak wspomniałem, będziemy korzystać z zewnętrznego API. W tym celu napiszemy efekt, który będzie reagował na akcję <code class="language-plaintext highlighter-rouge">[activity] Activities retrieved</code>, następnie wystosowywał żądanie HTTP, a po otrzymaniu odpowiedzi - dodawał ją do listy.</p>

<p>Pojawia się tutaj dość dużo zagadnień, zatem spójrzmy na ten fragment nieco inaczej. Zastanówmy się najpierw jak, używając dotychczas znanych nam narzędzi (na  przykład RxJs), moglibyśmy napisać logikę wywołującą żądanie na każde kliknięcie przycisku i przekazać je dalej. Jeśli założymy, że zdarzenie kliknięcia pojawia się w Observable <code class="language-plaintext highlighter-rouge">click$</code>, a strumień, na który ma trafić odpowiedź został nazwany <code class="language-plaintext highlighter-rouge">response$</code>, wówczas kod mógłby wyglądać tak:</p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">this</span><span class="p">.</span><span class="nx">response$</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">click$</span><span class="p">.</span><span class="nx">pipe</span><span class="p">(</span>
    <span class="nx">switchMap</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">http</span><span class="p">.</span><span class="kd">get</span><span class="o">&lt;</span><span class="nx">ActivityItemModel</span><span class="o">&gt;</span><span class="p">(</span><span class="dl">'</span><span class="s1">https://www.boredapi.com/api/activity</span><span class="dl">'</span><span class="p">)</span>
      <span class="p">.</span><span class="nx">pipe</span><span class="p">(</span>
        <span class="nx">catchError</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="nx">EMPTY</span><span class="p">)</span>
      <span class="p">))</span>
<span class="p">);</span>
</code></pre></div></div>

<p>Jeśli na tym etapie potrzebujesz chwili przerwy na zrozumienie co dzieje się w tym kodzie, to polecam <a href="/en/2020/01/09/rxjs-introduction.html">wpis o RxJs</a> dostępny na łamach naszego bloga.</p>

<p>Wracając do naszego efektu - w zasadzie większość mamy już napisaną! Pozostaje nam tylko kilka rzeczy:</p>
<ul>
  <li>efekt jest tak naprawdę serwisem, jakie znamy z codziennego pisania w Angularze, tworzymy zatem klasę <code class="language-plaintext highlighter-rouge">ActivityEffect</code> i dekorujemy ją przy pomocy <code class="language-plaintext highlighter-rouge">@Injectable()</code>.</li>
  <li>nie powinniśmy reagować bezpośrednio na zdarzenie kliknięcia przycisku, a na zgłoszone wcześniej akcję typu <code class="language-plaintext highlighter-rouge">activitiesRetrievedType</code>. Mamy do dyspozycji serwis <code class="language-plaintext highlighter-rouge">Actions</code>, który możemy traktować jak swoistą szynę, na którą trafiają wywołane akcje. Wstrzykujemy go więc przez konstruktor do efektu. Chcąc reagować wyłącznie na określony typ akcji korzystamy z operatora <code class="language-plaintext highlighter-rouge">ofType</code>.</li>
  <li>wynik żądania w naszym wypadku nie powinien trafiać do żadnego strumienia, tylko spowodować wywołanie akcji <code class="language-plaintext highlighter-rouge">activityAdded</code>. Wystarczy dodać  mapowanie w operatorze <code class="language-plaintext highlighter-rouge">pipe()</code>.</li>
</ul>

<p>Cały efekt wygląda wówczas tak:</p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">@</span><span class="nd">Injectable</span><span class="p">()</span>
<span class="k">export</span> <span class="kd">class</span> <span class="nx">ActivityEffect</span> <span class="p">{</span>

  <span class="kd">constructor</span><span class="p">(</span><span class="k">private</span> <span class="nx">actions$</span><span class="p">:</span> <span class="nx">Actions</span><span class="p">,</span> <span class="k">private</span> <span class="nx">http</span><span class="p">:</span> <span class="nx">HttpClient</span><span class="p">)</span> <span class="p">{</span>
  <span class="p">}</span>

  <span class="nx">getActivity$</span> <span class="o">=</span> <span class="nx">createEffect</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">actions$</span><span class="p">.</span><span class="nx">pipe</span><span class="p">(</span>
    <span class="nx">ofType</span><span class="p">(</span><span class="nx">activitiesRetrievedType</span><span class="p">),</span>
    <span class="nx">switchMap</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">http</span><span class="p">.</span><span class="kd">get</span><span class="o">&lt;</span><span class="nx">ActivityItemModel</span><span class="o">&gt;</span><span class="p">(</span><span class="dl">'</span><span class="s1">https://www.boredapi.com/api/activity</span><span class="dl">'</span><span class="p">)</span>
      <span class="p">.</span><span class="nx">pipe</span><span class="p">(</span>
        <span class="nx">map</span><span class="p">(</span><span class="nx">response</span> <span class="o">=&gt;</span> <span class="p">(</span><span class="nx">activityAdded</span><span class="p">(</span><span class="nx">response</span><span class="p">))),</span>
        <span class="nx">catchError</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="nx">EMPTY</span><span class="p">)</span>
      <span class="p">))</span>
  <span class="p">));</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Podsumowując: w wyniku działania tego efektu każde wywołanie akcji <code class="language-plaintext highlighter-rouge">[activity] Activities retrieved</code> przy poprawnej odpowiedzi z API wywoła akcję <code class="language-plaintext highlighter-rouge">[activity] Activity added</code> z otrzymaną czynnością. Można oczywiście tworzyć efekty obsługujące inne operacje, nie trzeba ograniczać się do żądań HTTP.</p>

<h3 id="reducer">Reducer</h3>
<p>W reducerach zazwyczaj znajduje się najwięcej logiki ze wszystkich komponentów NgRx. To tutaj trzeba zdecydować jak dodawać do store kolejne dane. Warto pamiętać, że reducery to <strong>czyste funkcje</strong>, które przyjmują jako parametr akcję i obecny stan aplikacji, a następnie zwracają nowy stan, dzięki czemu zachowujemy jego niemutowalność. W naszym przypadku wygląda to tak:</p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">initialState</span><span class="p">:</span> <span class="nx">ActivityItemsState</span> <span class="o">=</span> <span class="p">{</span><span class="na">activities</span><span class="p">:</span> <span class="p">[]};</span>

<span class="k">export</span> <span class="kd">const</span> <span class="nx">activityReducer</span> <span class="o">=</span> <span class="nx">createReducer</span><span class="p">(</span>
    <span class="nx">initialState</span><span class="p">,</span>
    <span class="nx">on</span><span class="p">(</span><span class="nx">addActivity</span><span class="p">,</span> <span class="p">(</span><span class="nx">state</span><span class="p">,</span> <span class="nx">payload</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">({</span>
        <span class="p">...</span><span class="nx">state</span><span class="p">,</span>
        <span class="na">activities</span><span class="p">:</span> <span class="nx">state</span><span class="p">.</span><span class="nx">activities</span><span class="p">.</span><span class="nx">concat</span><span class="p">({</span><span class="na">activity</span><span class="p">:</span> <span class="nx">payload</span><span class="p">.</span><span class="nx">activity</span><span class="p">,</span> <span class="na">participants</span><span class="p">:</span> <span class="nx">payload</span><span class="p">.</span><span class="nx">participants</span><span class="p">}</span> <span class="k">as</span> <span class="nx">ActivityItemModel</span><span class="p">)</span>
    <span class="p">}))</span>
<span class="p">);</span>
</code></pre></div></div>

<p>W pierwszej linii definiujemy, w jaki sposób ma zostać zainicjowany store (lub - jak ma to miejsce powyżej - jego wycinek). W naszym przypadku będzie to pusta tablica. Następnie wywołujemy funkcję <code class="language-plaintext highlighter-rouge">createReducer</code>, która w pierwszym parametrze przyjmuje wspomniany stan początkowy, a w drugim (i każdym kolejnym) odpowiednie handlery. W tym przypadku reducer reaguje na akcję <code class="language-plaintext highlighter-rouge">[activity] Activity added</code> poprzez dodanie do dotychczasowej tablicy <code class="language-plaintext highlighter-rouge">activities</code> nowego elementu i zwrócenie całości jako wynik wywołania funkcji.</p>

<p>Reducer jest częścią całej architektury, którą można w bardzo łatwy sposób przetestować i upewnić się, że działa poprawnie. W tym przypadku możemy napisać taki test:</p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">describe</span><span class="p">(</span><span class="dl">'</span><span class="s1">Activity reducer test</span><span class="dl">'</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="kd">function</span> <span class="nx">createState</span><span class="p">(</span><span class="na">activities</span><span class="p">:</span> <span class="nx">ActivityItemModel</span><span class="p">[]):</span> <span class="nx">ActivityItemsState</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">{</span><span class="na">activities</span><span class="p">:</span> <span class="p">[...</span><span class="nx">activities</span><span class="p">]};</span>
  <span class="p">}</span>

  <span class="nx">it</span><span class="p">(</span><span class="dl">'</span><span class="s1">should add new activity</span><span class="dl">'</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="c1">// given</span>
    <span class="kd">const</span> <span class="nx">state</span> <span class="o">=</span> <span class="nx">createState</span><span class="p">([]);</span>
    <span class="kd">const</span> <span class="nx">newActivityName</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">New activity</span><span class="dl">'</span><span class="p">;</span>
    <span class="kd">const</span> <span class="nx">newActivityParticipants</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
    <span class="kd">const</span> <span class="nx">action</span> <span class="o">=</span> <span class="nx">activityAdded</span><span class="p">({</span><span class="na">activity</span><span class="p">:</span> <span class="nx">newActivityName</span><span class="p">,</span> <span class="na">participants</span><span class="p">:</span> <span class="nx">newActivityParticipants</span><span class="p">});</span>

    <span class="c1">// when</span>
    <span class="kd">const</span> <span class="nx">newState</span> <span class="o">=</span> <span class="nx">activityReducer</span><span class="p">(</span><span class="nx">state</span><span class="p">,</span> <span class="nx">action</span><span class="p">);</span>

    <span class="c1">// then</span>
    <span class="nx">expect</span><span class="p">(</span><span class="nx">newState</span><span class="p">.</span><span class="nx">activities</span><span class="p">.</span><span class="nx">length</span><span class="p">).</span><span class="nx">toBe</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
    <span class="nx">expect</span><span class="p">(</span><span class="nx">newState</span><span class="p">.</span><span class="nx">activities</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">activity</span><span class="p">).</span><span class="nx">toEqual</span><span class="p">(</span><span class="nx">newActivityName</span><span class="p">);</span>
    <span class="nx">expect</span><span class="p">(</span><span class="nx">newState</span><span class="p">.</span><span class="nx">activities</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">participants</span><span class="p">).</span><span class="nx">toEqual</span><span class="p">(</span><span class="nx">newActivityParticipants</span><span class="p">);</span>
  <span class="p">});</span>
<span class="p">});</span>
</code></pre></div></div>
<p>Test przebiega następująco:</p>
<ul>
  <li>w sekcji <code class="language-plaintext highlighter-rouge">given</code> tworzymy sztuczny, pusty store oraz akcję <code class="language-plaintext highlighter-rouge">activityAdded</code>,</li>
  <li>w sekcji <code class="language-plaintext highlighter-rouge">when</code> wywołujemy interesujący nas reducer i przypisujemy wynik do zmiennej <code class="language-plaintext highlighter-rouge">newState</code></li>
  <li>w sekcji <code class="language-plaintext highlighter-rouge">then</code> sprawdzamy czy w store znajduje się jeden, dodany przez nas element i czy jego właściwości zgadzają sie z tym, co przekazaliśmy w akcji.</li>
</ul>

<p>Jeśli wszystkie trzy asercje zostaną spełnione, wówczas wiemy, że mechanizm dodawania nowej aktywności do store działa.</p>

<h3 id="selektor">Selektor</h3>
<p>Ostatnią częścią układanki w przepływie są selektory. Podobnie jak reducery są one czystymi funkcjami, których zadaniem jest obserwowanie wycinków store i dostarczanie informacji o ich zmianach do komponentów. Warto tu wspomnieć, że są one dobrym miejscem na to, by dane te odpowiednio przygotować, tak, by po trafieniu do komponentu mogły być „wygodnie” użyte. Dzięki temu komponent może całkowicie abstrahować od struktury store. W naszej aplikacji selektor zdefiniowany jest następująco:</p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">getActivitiesFeatureState</span> <span class="o">=</span> <span class="nx">createFeatureSelector</span><span class="o">&lt;</span><span class="nx">ActivityItemsState</span><span class="o">&gt;</span><span class="p">(</span><span class="dl">'</span><span class="s1">activitiesState</span><span class="dl">'</span><span class="p">);</span>

<span class="k">export</span> <span class="kd">const</span> <span class="nx">getActivities</span> <span class="o">=</span> <span class="nx">createSelector</span><span class="p">(</span><span class="nx">getActivitiesFeatureState</span><span class="p">,</span> <span class="nx">state</span> <span class="o">=&gt;</span> <span class="nx">state</span><span class="p">.</span><span class="nx">activities</span><span class="p">);</span>
</code></pre></div></div>

<p>Najpierw, przy pomocy funkcji <code class="language-plaintext highlighter-rouge">createFeatureSelector</code> tworzymy tzw. feature selector pozwalający na wyciągnięcie pojedynczego wycinka (<em>slice</em>) danych, nazwanego przez nas <code class="language-plaintext highlighter-rouge">activitiesState</code>. Następnie używamy go tworząc właściwy selektor przy pomocy funkcji <code class="language-plaintext highlighter-rouge">createSelector</code> i wskazując go w pierwszym jej argumencie. Drugim parametrem jest funkcja wskazująca, które dane chcemy otrzymać w wyniku działania selektora. W naszym przypadku jest to tablica czynności, o nazwie <code class="language-plaintext highlighter-rouge">activities</code>. Tak zbudowany selektor jest gotowy do użycia w komponencie.</p>

<p>Na początku tego punktu wspomniałem, że selektory są czystymi funkcjami, co między innymi oznacza, że przy zachowaniu tego samego stanu i dla tych samych parametrów wielu wywołań zawsze zwrócą ten sam wynik. Ta właściwość została wykorzystana w mechanizmie nazywanym „memoization” (zapamiętywanie). Dzięki niemu NgRx zapamiętuje, z jakimi argumentami ostatnio wywoływany był dany selektor. Jeśli nie uległy one zmianie, wówczas zwraca wynik poprzedniego wywołania selektora, nie wykonując logiki pobierania danych ze store.</p>

<h3 id="spięcie-całości">Spięcie całości</h3>
<p>Mamy już wszystkie potrzebne części logiki NgRx, z których chcemy skorzystać. Pozostaje już tylko dowiedzieć się, jak ich użyć. Pokażę sytuację, w której użytkownik klika przycisk odpowiadający za pobranie przykładowej aktywności z API, przechodząc jednocześnie przez odpowiednie miejsca w kodzie. W trakcie czytania zachęcam do spoglądania na zamieszczony wcześniej w poście diagram przepływu.</p>

<ol>
  <li>Zacznijmy od komponentu wywołującego początkową akcję typu <code class="language-plaintext highlighter-rouge">[activity] Activities retrieved</code>. Budowa klasy tego komponentu może wyglądać następująco (pomijam <em>template</em>):
    <div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">export</span> <span class="kd">class</span> <span class="nx">ActivityApiComponent</span> <span class="p">{</span>

 <span class="kd">constructor</span><span class="p">(</span><span class="k">private</span> <span class="nx">store</span><span class="p">:</span> <span class="nx">Store</span><span class="o">&lt;</span><span class="nx">State</span><span class="o">&gt;</span><span class="p">)</span> <span class="p">{</span>
 <span class="p">}</span>

 <span class="nx">getActivity</span><span class="p">():</span> <span class="k">void</span> <span class="p">{</span>
     <span class="k">this</span><span class="p">.</span><span class="nx">store</span><span class="p">.</span><span class="nx">dispatch</span><span class="p">(</span><span class="nx">getActivity</span><span class="p">());</span>
 <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>    </div>
    <p>Jak widać w konstruktorze, wstrzykujemy obiekt Store, na którym wykonujemy metodę <code class="language-plaintext highlighter-rouge">dispatch</code> podając w jej argumencie typ akcji. Na tym kończy się odpowiedzialność komponentu.</p>
  </li>
  <li>Wysłaną akcję przechwytuje efekt, który, zgodnie z kodem zaprezentowanym wcześniej, wysyła żądanie do API, a otrzymawszy odpowiedź przekazuje ją jako argument nowej akcji <code class="language-plaintext highlighter-rouge">[activity] Activity added</code>.</li>
  <li>Akcja typu <code class="language-plaintext highlighter-rouge">[activity] Activity added</code> jest przechwytywana przez reducer, który wyłuskuje z niej przekazaną z API odpowiedź i dodaje do store.</li>
  <li>W ostatniej kolejności do gry wchodzi selektor, który wykrywa zmianę store wynikającą z działania reducera. Użycie selektora w komponencie może wyglądać następująco:</li>
</ol>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">export</span> <span class="kd">class</span> <span class="nx">ActivityListComponent</span> <span class="k">implements</span> <span class="nx">OnInit</span> <span class="p">{</span>

    <span class="nx">activities$</span><span class="p">:</span> <span class="nx">Observable</span><span class="o">&lt;</span><span class="nx">ActivityItemModel</span><span class="p">[]</span><span class="o">&gt;</span><span class="p">;</span>

    <span class="kd">constructor</span><span class="p">(</span><span class="k">private</span> <span class="nx">store</span><span class="p">:</span> <span class="nx">Store</span><span class="o">&lt;</span><span class="nx">State</span><span class="o">&gt;</span><span class="p">)</span> <span class="p">{</span>
    <span class="p">}</span>

    <span class="nx">ngOnInit</span><span class="p">():</span> <span class="k">void</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">activities$</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">store</span><span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="nx">getActivities</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>
<p>W metodzie <code class="language-plaintext highlighter-rouge">ngOnInit</code> wskazujemy, że chcemy reagować na zmiany store przy pomocy selektora <code class="language-plaintext highlighter-rouge">getActivities</code>. Zmiennej <code class="language-plaintext highlighter-rouge">activities$</code> możemy następnie użyć w ciele komponentu przy pomocy async pipe, na przykład:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;div</span> <span class="na">*ngFor=</span><span class="s">"let activity of activities$ | async"</span><span class="nt">&gt;</span>
    <span class="c">&lt;!-- wnętrze komponentu listy --&gt;</span>
<span class="nt">&lt;/div&gt;</span>
</code></pre></div></div>

<p>Tym samym cały proces dobiega końca, a kolejne kliknięcie przycisku wywoła go od nowa.</p>

<h2 id="inne-podejścia">Inne podejścia</h2>
<p>Warto wspomnieć, że tak, jak dla Angulara istnieje biblioteka NgRx, tak również dla pozostałych frameworków z tzw. wielkiej trójcy znajdziemy implementacje architektury Redux:</p>
<ul>
  <li>Redux dla Reacta</li>
  <li>Vuex dla Vue</li>
</ul>

<p>Należy również zaznaczyć, że Redux nie jest jedynym sposobem na zarządzanie stanem. Można tutaj wymienić takie alternatywy, jak:</p>
<ul>
  <li><a href="https://mobx.js.org/README.html">MobX</a></li>
  <li><a href="https://cycle.js.org/">Cycle.js</a></li>
  <li><a href="https://github.com/facebook/flux">Flux</a> - warto wiedzieć, że Flux był protoplastą Reduxa</li>
  <li><a href="https://www.apollographql.com/">Apollo</a></li>
</ul>

<h2 id="podsumowanie">Podsumowanie</h2>
<p>Łatwo zauważyć, że na pierwszy ogień NgRx, czy szerzej - Redux - potrafią nieco przytłoczyć ilością kodu, którą trzeba napisać, by nawet drobne funkcjonalności działały. Jest to jeden z największych zarzutów wobec tego rozwiązania, więc jeśli takie były Twoje odczucia podczas czytania tego artykułu - gratuluję krytycznego myślenia! Zauważmy jednak, że po przebrnięciu przez początkowe trudności zostajemy z aplikacją, którą bardzo łatwo możemy przetestować, rozszerzać i której działanie jest jasno zdefiniowane. Chcę też zwrócić uwagę, że przytaczane tutaj przykłady były trywialne, w związku z czym stosunek tzw. boilerplate kodu do faktycznej logiki jest duży. W przypadku złożonych aplikacji, w których sens użycia bibliotek takich jak NgRx jest znacznie większy, narzut ten staje się dużo bardziej akceptowalny.</p>

<p>Mam nadzieję, że tym artykułem zainspirowałem nieco do zainteresowania się tematem zarządzania stanem aplikacji frontendowych. Serdecznie zapraszam do rozpoznawania tematu we własnym zakresie, gdyż przedstawiłem tu zaledwie namiastkę możliwości, jakie zapewnia Redux i NgRx.</p>

<h3 id="linki">Linki</h3>
<ul>
  <li><a href="https://github.com/Chrrapek/BoredNgRx">Repozytorium z projektem</a></li>
  <li><a href="https://ngrx.io/docs">Dokumentacja NgRx</a></li>
</ul>

                            
                        </div>
                    </div>
                </div>
            </div>
            <div class="sidebar-desktop">
                
<div class="sidebar-container latest-posts">
    <div class="sidebar-title">
        Newest posts
    </div>
    <hr class="latest-posts-separator">
    <div class="sidebar-latest-posts-container">
        <ul class="sidebar-posts"><li class="sidebar-post no-breaking-word star-icon">
                <a href="/en/2021/09/13/kafka-retry-dlq.html" lang="pl">Reliable event delivery in Apache Kafka based on retry and DLQ</a>
            </li><li class="sidebar-post no-breaking-word star-icon">
                <a href="/en/2021/09/08/kouncil-event-tracking-kafka.html" lang="pl">Event Tracking - finding a needle in a haystack</a>
            </li><li class="sidebar-post no-breaking-word star-icon">
                <a href="/en/2021/08/30/kouncil-introduction.html" lang="pl">Kouncil - a modern Kafka frontend</a>
            </li></ul>
    </div>
</div>

                <div class="sidebar-container offers" id="offers-sidebar">
    <div class="sidebar-title offers-title">
        Join us
    </div>
    <hr class="offers-separator">
    <ul class="sidebar-posts offers-list">
        <li class="sidebar-post no-breaking-word">
            <a href="https://consdata.com/pl/kariera/trwajace-rekrutacje/poznan/senior-fullstack-developer-java-angular"
               lang="pl">
                <div class="job-offer">
                    <span class="job-title">SENIOR FULLSTACK DEVELOPER (JAVA + ANGULAR)</span>
                    <span class="job-description">Poznań (hybrydowo) lub zdalnie</span>
                    <span class="job-salary">
                            UoP 14 900 - 20 590 PLN brutto <br/>
                            B2B 19 680 - 27 220 PLN netto
                        </span>
                </div>
            </a>
        </li>
        <li class="sidebar-post no-breaking-word">
            <a href="https://consdata.com/pl/kariera/trwajace-rekrutacje/poznan/regular-fullstack-developer-java-angular"
               lang="pl">
                <div class="job-offer">
                    <span class="job-title">REGULAR FULLSTACK DEVELOPER (JAVA + ANGULAR)</span>
                    <span class="job-description">Poznań (hybrydowo) lub zdalnie</span>
                    <span class="job-salary">
                            UoP 11 300 - 15 900 PLN brutto <br/>
                            B2B 14 950 - 21 000 PLN netto
                        </span>
                </div>
            </a>
        </li>
        <li class="sidebar-post no-breaking-word">
            <a class="clickable-offer" href="https://www.consdata.com/pl/kariera/trwajace-rekrutacje#tag-developer">
                <div class="other-job-offers">
                    <span class="job-title">ZOBACZ WSZYSTKIE OGŁOSZENIA</span>
                </div>
            </a>
        </li>
    </ul>
</div>

                
<div class="sidebar-container newsletter-sidebar-tile">
    <div class="newsletter-tile-title-container">
        
        <h2 class="newsletter-tile-title">technical</h2>
        <h2 class="newsletter-tile-title">newsletter</h2>
    
    </div>
    <a href="#newsletter-form" class="sign-up-btn">Sign up</a>
</div>

            </div>
        </div>
        <div class="recommended-container" id="recommended-posts-container">
    <h2 class="title">
        Podobne wpisy
    </h2>
    <div id="latest-posts-container" class="latest-posts-container">



<div class="post-tile">
    <a class="small-post-image" href="/en/2021/09/13/kafka-retry-dlq.html">
        <img class="tile-image small-post-image" src="/assets/img/posts/2021-09-13-kafka-retry-dlq/thumbnail.webp" alt="post-image"/>
    </a>
    <div class="post-tile-content">
        <div class="badge-panel">
            <div class="badge">kouncil</div>
        </div>
        <h4 class="post-title no-breaking-word">
            <a href="/en/2021/09/13/kafka-retry-dlq.html">Reliable event delivery in Apache Kafka based on retry and DLQ</a>
        </h4>

        <p class="post-description no-breaking-word">
            <a href="/en/2021/09/13/kafka-retry-dlq.html">
                
                Why is there no DLQ in Kafka? Most popular queueing systems such as RabbitMQ or ActiveMQ have built-in systems responsible for reliable message delivery. So why doesn't Kafka offer one?...
                
            </a>
        </p>

        <div class="tile-author"><a href="/en/authors/jgrobelny.html" class="author-name author-img">
                <img class="small-author-image" src="/assets/img/authors/jgrobelny.webp" alt="author">
            </a>
            <div class="post-info">
                <a href="/en/authors/jgrobelny.html" class="author-name">Jacek Grobelny</a>
                <span class="post-date">
13


Sep


2021
</span>
            </div></div>
    </div>
</div>




<div class="post-tile">
    <a class="small-post-image" href="/en/2021/09/08/kouncil-event-tracking-kafka.html">
        <img class="tile-image small-post-image" src="/assets/img/posts/2021-09-08-kouncil-event-tracking-kafka/thumbnail.webp" alt="post-image"/>
    </a>
    <div class="post-tile-content">
        <div class="badge-panel">
            <div class="badge">kouncil</div>
        </div>
        <h4 class="post-title no-breaking-word">
            <a href="/en/2021/09/08/kouncil-event-tracking-kafka.html">Event Tracking - finding a needle in a haystack</a>
        </h4>

        <p class="post-description no-breaking-word">
            <a href="/en/2021/09/08/kouncil-event-tracking-kafka.html">
                
                Event tracking allows for tracking and visualising the path of a given event or process through Kafka topics.
                
            </a>
        </p>

        <div class="tile-author"><a href="/en/authors/mmergo.html" class="author-name author-img">
                <img class="small-author-image" src="/assets/img/authors/mmergo.webp" alt="author">
            </a>
            <div class="post-info">
                <a href="/en/authors/mmergo.html" class="author-name">Marcin Mergo</a>
                <span class="post-date">
8


Sep


2021
</span>
            </div></div>
    </div>
</div>




<div class="post-tile">
    <a class="small-post-image" href="/en/2021/08/30/kouncil-introduction.html">
        <img class="tile-image small-post-image" src="/assets/img/posts/2021-08-30-kouncil-introduction/thumbnail.webp" alt="post-image"/>
    </a>
    <div class="post-tile-content">
        <div class="badge-panel">
            <div class="badge">kouncil</div>
        </div>
        <h4 class="post-title no-breaking-word">
            <a href="/en/2021/08/30/kouncil-introduction.html">Kouncil - a modern Kafka frontend</a>
        </h4>

        <p class="post-description no-breaking-word">
            <a href="/en/2021/08/30/kouncil-introduction.html">
                
                Kouncil is a modern Kafka frontend equipped with features essential for developers.
                
            </a>
        </p>

        <div class="tile-author"><a href="/en/authors/jgrobelny.html" class="author-name author-img">
                <img class="small-author-image" src="/assets/img/authors/jgrobelny.webp" alt="author">
            </a>
            <div class="post-info">
                <a href="/en/authors/jgrobelny.html" class="author-name">Jacek Grobelny</a>
                <span class="post-date">
30


Aug


2021
</span>
            </div></div>
    </div>
</div>
</div>
    <img id="arrow-icon" onclick="toggleRecommendation()" class="arrow rotated" src="/assets/icon/arrow.svg">
</div>

<script>

    let expended = false;
    const arrowIcon = document.getElementById("arrow-icon")

    function toggleRecommendation() {
        if (expended) {
            document.getElementById("latest-posts-container").classList.remove("hide");
            arrowIcon.classList.add("rotated");
        } else {
            document.getElementById("latest-posts-container").classList.add("hide");
            arrowIcon.classList.remove("rotated");
        }
        
        expended = !expended;
    }

</script>

        <div class="consdata-offers-mobile">
            <div class="sidebar-container offers" id="offers-sidebar">
    <div class="sidebar-title offers-title">
        Join us
    </div>
    <hr class="offers-separator">
    <ul class="sidebar-posts offers-list">
        <li class="sidebar-post no-breaking-word">
            <a href="https://consdata.com/pl/kariera/trwajace-rekrutacje/poznan/senior-fullstack-developer-java-angular"
               lang="pl">
                <div class="job-offer">
                    <span class="job-title">SENIOR FULLSTACK DEVELOPER (JAVA + ANGULAR)</span>
                    <span class="job-description">Poznań (hybrydowo) lub zdalnie</span>
                    <span class="job-salary">
                            UoP 14 900 - 20 590 PLN brutto <br/>
                            B2B 19 680 - 27 220 PLN netto
                        </span>
                </div>
            </a>
        </li>
        <li class="sidebar-post no-breaking-word">
            <a href="https://consdata.com/pl/kariera/trwajace-rekrutacje/poznan/regular-fullstack-developer-java-angular"
               lang="pl">
                <div class="job-offer">
                    <span class="job-title">REGULAR FULLSTACK DEVELOPER (JAVA + ANGULAR)</span>
                    <span class="job-description">Poznań (hybrydowo) lub zdalnie</span>
                    <span class="job-salary">
                            UoP 11 300 - 15 900 PLN brutto <br/>
                            B2B 14 950 - 21 000 PLN netto
                        </span>
                </div>
            </a>
        </li>
        <li class="sidebar-post no-breaking-word">
            <a class="clickable-offer" href="https://www.consdata.com/pl/kariera/trwajace-rekrutacje#tag-developer">
                <div class="other-job-offers">
                    <span class="job-title">ZOBACZ WSZYSTKIE OGŁOSZENIA</span>
                </div>
            </a>
        </li>
    </ul>
</div>

        </div>
        <div class="newsletter-sub-container" id="newsletter-sub-container">
    <div class="title">
        
        <h2>Sign up for a </h2>
        <h2>technical </h2>
        <h2 class="newsletter">newsletter</h2>
        
    </div>
    <div id="newsletter-form" class="newsletter-agreement-form-content">
        <form class="newsletter-form" action="https://app2.salesmanago.pl/form/e7yrrpjmxbm7bahc/contact.htm" method="post" target="_blank" onsubmit="">
            <input type="hidden" name="lang" value="pl">
            <input type="hidden" name="formId" value="fe234ba7-932a-438e-aca0-0cf324930910">
            <input type="hidden" value="true" name="sm-form-consent-id-2634-NEWSLETTER_JAVA">
            <div class="form-inputs">
                <input required placeholder="Name *" name="sm-form-name"/>
                <input required type="email" placeholder="E-mail" name="sm-form-email"/>
            </div>
            <div class="form-checkbox-container">
                <label class="form-checkbox">
                    <input required type="checkbox" name="sm-form-consent-name-NEWSLETTER_JAVA"/>
                    <div class="form-checkbox-input"></div>
                    <span>By submitting the form, you consent to the processing of your data in accordance with the Privacy Policy*.</span>
                </label>
            </div>
            <button class="sign-up-btn">Sign up</button>
        </form>
    </div>
</div>

    </article>
</div>
<script>
    const language = 'en';
    const jsonPath = language === 'en' ? '/en/json/posts.json' : '/json/posts.json';
    fetch(jsonPath)
        .then(response => response.json())
        .then(store => {
            function displayResults(results) {
                if (results.length > 0) {
                    const container = document.getElementById("recommended-posts");
                    results
                        .forEach(result => {
                            const item = store[result.ref];
                            if (item.lang === language) {
                                const listElement = document.createElement('li');
                                const anchor = document.createElement('a');
                                const postTitle = document.createTextNode(item.title);
                                listElement.classList.add('sidebar-post');
                                listElement.classList.add('no-breaking-word');
                                anchor.setAttribute('href', item.url);
                                anchor.setAttribute('lang', 'pl');
                                anchor.appendChild(postTitle);
                                listElement.appendChild(anchor);
                                container.appendChild(listElement);
                            }
                        });
                    if (container.children.length < 1) {
                        hideRecommendedPosts();
                    }
                } else {
                    hideRecommendedPosts();
                }

            }

            const tags = "frontend redux state management zarządzanie stanem store reducer action effect angular react";
            const idx = lunr(function () {
                this.field('tags');

                for (let key in store) {
                    this.add({
                        'id': key,
                        'title': store[key].title,
                        'tags': store[key].tags,
                    });
                }
            });
            const results = idx.search(tags).slice(1, 4);
            displayResults(results);
        })

    function hideRecommendedPosts() {
        document.getElementById("recommended-posts-container").style.display = 'none';
    }
</script>

</main><footer>
    <div class="container">
        <a class="footer-logo" href="https://consdata.com/pl">
            <img src="/assets/img/logo.png" alt="consdata.com">
        </a>
        <div class="footer-content">
            <div class="footer-menu">
                <ul class="menu">
                    <li class="menu-item">
                        <p class="menu-title">Contact</p>
                        <ul class="submenu">
                            <li>
                                <a href="mailto:sales@consdata.com">sales@consdata.com</a>
                            </li>
                            <li>
                                <p>+48 61 41 51 000</p>
                            </li>
                        </ul>
                    </li>
                    <li class="menu-item">
                        <p class="menu-title">Office</p>
                        <ul class="submenu">
                            <li>
                                <p>K9Office<br>Krysiewicza 9/14<br>61-825 Poznań<br>Polska</p>
                            </li>
                        </ul>
                    </li>
                    <li class="menu-item">
                        <p class="menu-title">Solutions</p>
                        <ul class="submenu">
                            <li>
                                <a href="https://eximee.com" target="_blank">Eximee</a>
                            </li>
                            <li>
                                <a href="https://kouncil.io" target="_blank">Kouncil</a>
                            </li>
                        </ul>
                    </li>
                    <li class="menu-item">
                        <a href="/en/" class="menu-title">Blog</a>
                        <a href="https://consdata.com/pl/kariera/trwajace-rekrutacje" class="menu-title"
                           target="_blank">Join us</a>
                    </li>
                </ul>
            </div>
        </div>
    </div>
    <div class="small-footer-container">
        <div class="footer-copyright">
            <span>Copyright © 2024 Consdata. All rights reserved.</span>
            <span>
                <a href="https://consdata.com/pl/polityka-prywatnosci"
                     class="privacy-policy">Privacy Policy & Cookies</a>
            </span>
        </div>
        <div class="social-footer">
            <a target="_blank" href="https://www.facebook.com/consdatacom">
                <img class="icon" src="/assets/icon/social-f.svg">
            </a>
            <a target="_blank" href="https://www.linkedin.com/company/consdata">
                <img class="icon" src="/assets/icon/social-in.svg">
            </a>
            <a target="_blank" href="https://github.com/Consdata">
                <img class="icon" src="/assets/icon/github.svg">
            </a>
            <a target="_blank" href="https://forum.eximee.com/">
                <img class="icon" src="/assets/icon/social-icon.svg">
            </a>
        </div>
    </div>
</footer>
<div class="cookie-notice" id="cookie-notice">
    <i onclick="hideConsent()" class="close-consent fa fa-times close"></i>
    <div class="cookie-container">
        <span>
            
            Chcemy używać plików cookie oraz skryptów podmiotów trzecich do polepszania funkcjonowania tej strony
        </span>
        <a id="cookie-notice-accept" class="consent-button">Zgadzam się</a>
    </div>
        <noscript><img height="1" width="1" style="display:none"
                   src="https://www.facebook.com/tr?id=300808861525851&ev=PageView&noscript=1"
    /></noscript>
</div>

<script>
    function createCookie(name, value, days) {
        let expires = "";
        if (days) {
            const date = new Date();
            date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));
            expires = "; expires=" + date.toUTCString();
        }
        document.cookie = name + "=" + value + expires + "; path=/";
    }

    function readCookie(name) {
        const nameEQ = name + "=";
        const ca = document.cookie.split(';');
        for (let i = 0; i < ca.length; i++) {
            let c = ca[i];
            while (c.charAt(0) === ' ') c = c.substring(1, c.length);
            if (c.indexOf(nameEQ) === 0) return c.substring(nameEQ.length, c.length);
        }
        return null;
    }

    function eraseCookie(name) {
        createCookie(name, "", -1);
    }

    function hideConsent() {
        document.getElementById('cookie-notice').style.display = 'none';
    }

    if (readCookie('cookie-notice-dismissed') === 'true') {!function (f, b, e, v, n, t, s) {
    if (f.fbq) return;
    n = f.fbq = function () {
        n.callMethod ?
            n.callMethod.apply(n, arguments) : n.queue.push(arguments)
    };
    if (!f._fbq) f._fbq = n;
    n.push = n;
    n.loaded = !0;
    n.version = '2.0';
    n.queue = [];
    t = b.createElement(e);
    t.async = !0;
    t.src = v;
    s = b.getElementsByTagName(e)[0];
    s.parentNode.insertBefore(t, s)
}(window, document, 'script',
    'https://connect.facebook.net/en_US/fbevents.js');
fbq('init', '300808861525851');
fbq('track', 'PageView');
} else {
        document.getElementById('cookie-notice').style.display = 'flex';
    }

    document.getElementById('cookie-notice-accept').addEventListener("click", function () {
        createCookie('cookie-notice-dismissed', 'true', 31);
        hideConsent();
        location.reload();
    });
</script>

</body>
</html>
